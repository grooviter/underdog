
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://grooviter.github.io/underdog/blog/2024/12/20/linear-regression-notes/">
      
      
      
        <link rel="next" href="../classifying-food/">
      
      
      <link rel="icon" href="../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>Linear regression notes - Underdog</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#linear-regression-notes" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../.." title="Underdog" class="md-header__button md-logo" aria-label="Underdog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Underdog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Linear regression notes
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/grooviter/underdog" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../.." class="md-tabs__link">
        
  
    
  
  Underdog

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../dataframe/" class="md-tabs__link">
        
  
    
  
  DataFrame

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../graphs/" class="md-tabs__link">
        
  
    
  
  Graphs

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../ml/" class="md-tabs__link">
        
  
    
  
  ML

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../plots/" class="md-tabs__link">
        
  
    
  
  Plots

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../ta/" class="md-tabs__link">
        
  
    
  
  Technical Analysis

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../development/" class="md-tabs__link">
        
  
    
  
  Development

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../../" class="md-tabs__link">
          
  
    
  
  Blog

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="Underdog" class="md-nav__button md-logo" aria-label="Underdog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Underdog
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/grooviter/underdog" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Underdog
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../dataframe/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DataFrame
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../graphs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Graphs
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../ml/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ML
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../plots/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plots
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../ta/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Technical Analysis
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../development/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Development
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Blog
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8" id="__nav_8_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Blog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2" >
        
          
          <label class="md-nav__link" for="__nav_8_2" id="__nav_8_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Archive
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2">
            <span class="md-nav__icon md-icon"></span>
            Archive
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2024/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2024
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_3" >
        
          
          <label class="md-nav__link" for="__nav_8_3" id="__nav_8_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Categories
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_3">
            <span class="md-nav__icon md-icon"></span>
            Categories
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/ml/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ml
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
  <div class="md-content md-content--post" data-md-component="content">
    <div class="md-sidebar md-sidebar--post" data-md-component="sidebar" data-md-type="navigation">
      <div class="md-sidebar__scrollwrap">
        <div class="md-sidebar__inner md-post">
          <nav class="md-nav md-nav--primary">
            <div class="md-post__back">
              <div class="md-nav__title md-nav__container">
                <a href="../../../../" class="md-nav__link">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
                  <span class="md-ellipsis">
                    Back to index
                  </span>
                </a>
              </div>
            </div>
            
            <ul class="md-post__meta md-nav__list">
              <li class="md-nav__item md-nav__item--section">
                <div class="md-post__title">
                  <span class="md-ellipsis">
                    Metadata
                  </span>
                </div>
                <nav class="md-nav">
                  <ul class="md-nav__list">
                    <li class="md-nav__item">
                      <div class="md-nav__link">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5z"/></svg>
                        <time datetime="2024-12-20 00:00:00+00:00" class="md-ellipsis">December 20, 2024</time>
                      </div>
                    </li>
                    
                    
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 3v15h3V3zm3 2 4 13 3-1-4-13zM5 5v13h3V5zM3 19v2h18v-2z"/></svg>
                          <span class="md-ellipsis">
                            in
                            
                              <a href="../../../../category/ml/">ml</a></span>
                        </div>
                      </li>
                    
                    
                      
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m0-18a10 10 0 0 1 10 10 10 10 0 0 1-10 10C6.47 22 2 17.5 2 12A10 10 0 0 1 12 2m.5 5v5.25l4.5 2.67-.75 1.23L11 13V7z"/></svg>
                          <span class="md-ellipsis">
                            
                              12 min read
                            
                          </span>
                        </div>
                      </li>
                    
                  </ul>
                </nav>
              </li>
            </ul>
          </nav>
          
            

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-is-linear-regression" class="md-nav__link">
    <span class="md-ellipsis">
      What is linear regression ?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple-linear-regression" class="md-nav__link">
    <span class="md-ellipsis">
      Simple linear regression
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#polynomial-transformation" class="md-nav__link">
    <span class="md-ellipsis">
      Polynomial transformation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#feature-selection" class="md-nav__link">
    <span class="md-ellipsis">
      Feature selection
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#regularization-and-normalization" class="md-nav__link">
    <span class="md-ellipsis">
      Regularization and normalization
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#regularization-baseline" class="md-nav__link">
    <span class="md-ellipsis">
      Regularization Baseline
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ridge" class="md-nav__link">
    <span class="md-ellipsis">
      Ridge
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lasso" class="md-nav__link">
    <span class="md-ellipsis">
      Lasso
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pca" class="md-nav__link">
    <span class="md-ellipsis">
      PCA
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
          
        </div>
      </div>
    </div>
    <article class="md-content__inner md-typeset">
      
        

  
  


<h1 id="linear-regression-notes">Linear regression notes</h1>
<p>Classification is a great method to predict discrete values from a given dataset, but sometimes you need to <strong>predict a continuous value</strong>, e.g: height, weight, prices... And that’s when linear regression techniques come handy.</p>
<!-- more -->

<h2 id="what-is-linear-regression">What is linear regression ?</h2>
<p>The definition that I read in the Wikipedia didn’t help me at all. Instead when I related it with a line, it started to make sense to me. If we’ve got a linear function, that is, a function describing a line, where <strong>ŵ</strong> is the <strong>slope of the line</strong> and <strong>b</strong> is called <strong>the intercept</strong> which is a constant value:</p>
<figure>
<img alt="" src="../../images/linear_regression_notes/plot.png#only-light" width="60%" />
<img alt="" src="../../images/linear_regression_notes/plot_dark.png#only-dark" width="60%" />
</figure>
<p>For every x value a new point will be drawn and eventually altogether will form a line. So, if you think about it visually, given a set of input values, a simple linear regression algorithm will try to come up with a line trying to pass as close as possible to the majority of the input dataset points. So if you try to predict an output value from the input values, the machine learning process will pick up a value from that line.</p>
<p>There are differences between the types of linear regression techniques depending on the <strong>presence of regularization</strong> (Ridge and Lasso), or the lack of it (Simple Linear Regression). It's also worth mentioning the use of <strong>normalization</strong>, <strong>feature generation</strong> (polynomial transformation) and <strong>feature compression</strong> (PCA).</p>
<h2 id="prerequisites">Prerequisites</h2>
<p>For this entry you should need the following dependencies:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:3"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><input id="__tabbed_1_3" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Gradle</label><label for="__tabbed_1_2">Maven</label><label for="__tabbed_1_3">Grapes</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-groovy highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">implementation</span><span class="w"> </span><span class="s2">&quot;com.github.grooviter:underdog-ml:VERSION&quot;</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">implementation</span><span class="w"> </span><span class="s2">&quot;com.github.grooviter:underdog-plots:VERSION&quot;</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-xml highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nt">&lt;dependency&gt;</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">    </span><span class="nt">&lt;groupId&gt;</span>com.github.grooviter<span class="nt">&lt;/groupId&gt;</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">    </span><span class="nt">&lt;artifactId&gt;</span>underdog-ml<span class="nt">&lt;/artifactId&gt;</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">    </span><span class="nt">&lt;version&gt;</span>VERSION<span class="nt">&lt;/version&gt;</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="nt">&lt;/dependency&gt;</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="nt">&lt;dependency&gt;</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="w">    </span><span class="nt">&lt;groupId&gt;</span>com.github.grooviter<span class="nt">&lt;/groupId&gt;</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="w">    </span><span class="nt">&lt;artifactId&gt;</span>underdog-plots<span class="nt">&lt;/artifactId&gt;</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="w">    </span><span class="nt">&lt;version&gt;</span>VERSION<span class="nt">&lt;/version&gt;</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="nt">&lt;/dependency&gt;</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-groovy highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nd">@Grapes</span><span class="o">([</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="nd">@Grab</span><span class="o">(</span><span class="s2">&quot;com.github.grooviter:underdog-ml:VERSION&quot;</span><span class="o">),</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="nd">@Grab</span><span class="o">(</span><span class="s2">&quot;com.github.grooviter:underdog-plots:VERSION&quot;</span><span class="o">)</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="o">])</span>
</span></code></pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>ml and plots modules already have underdog-dataframe dependency as transitive dependency so you don't have to explicitly declare it.</p>
</div>
<h2 id="simple-linear-regression">Simple linear regression</h2>
<p>The most popular linear regression uses the least squares technique. It tries to find a slope (w) and constant value (b) that minimizes the mean squared error of the model. It doesn’t have parameters to control model complexity, everything it needs is estimated from training data.</p>
<div class="admonition note">
<p class="admonition-title">UC Irvine Dataset</p>
<p>The <a href="https://archive.ics.uci.edu/dataset/275/bike+sharing+dataset">dataset</a> used for this entry is a Bike sharing 
dataset from the <a href="https://archive.ics.uci.edu/">UCI Dataset repository</a> for machine learning. </p>
</div>
<p>First of all I'm loading the <a href="https://archive.ics.uci.edu/dataset/275/bike+sharing+dataset">Bike sharing</a> daily dataset. We are removing non-numerical series and rows with
missing values:</p>
<div class="language-groovy highlight"><span class="filename">loading data</span><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">underdog.Underdog</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="kt">def</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Underdog</span><span class="o">.</span><span class="na">df</span><span class="o">()</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="w">    </span><span class="o">.</span><span class="na">read_csv</span><span class="o">(</span><span class="n">FILE_PATH</span><span class="o">,</span><span class="w"> </span><span class="nl">dateFormat:</span><span class="w"> </span><span class="s1">&#39;yyyy-MM-dd&#39;</span><span class="o">)</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="w">    </span><span class="o">.</span><span class="na">dropna</span><span class="o">()</span><span class="w">  </span><span class="c1">// removing missing values</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="w">    </span><span class="o">.</span><span class="na">sort_values</span><span class="o">(</span><span class="nl">by:</span><span class="w"> </span><span class="o">[</span><span class="s1">&#39;dteday&#39;</span><span class="o">])</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="w">    </span><span class="o">.</span><span class="na">drop</span><span class="o">(</span><span class="s1">&#39;instant&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;yr&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;casual&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;cnt&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;dteday&#39;</span><span class="o">)</span><span class="w"> </span><span class="c1">// removing some columns</span>
</span></code></pre></div>
<p>Which outputs:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="w">                                            </span>day.csv
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="w"> </span>season<span class="w">  </span><span class="p">|</span><span class="w">  </span>mnth<span class="w">  </span><span class="p">|</span><span class="w">  </span>holiday<span class="w">  </span><span class="p">|</span><span class="w">  </span>weekday<span class="w">  </span><span class="p">|</span><span class="w">  </span>workingday<span class="w">  </span><span class="p">|</span><span class="w">  </span>weathersit<span class="w">  </span><span class="p">|</span><span class="w">    </span>temp<span class="w">    </span><span class="p">|</span><span class="w">   </span>atemp<span class="w">    </span><span class="p">|</span><span class="w">    </span>hum<span class="w">     </span><span class="p">|</span><span class="w">  </span>windspeed<span class="w">  </span><span class="p">|</span><span class="w">  </span>registered<span class="w">  </span><span class="p">|</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>---------------------------------------------------------------------------------------------------------------------------------------------
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">      </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">     </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">        </span><span class="m">0</span><span class="w">  </span><span class="p">|</span><span class="w">        </span><span class="m">6</span><span class="w">  </span><span class="p">|</span><span class="w">           </span><span class="m">0</span><span class="w">  </span><span class="p">|</span><span class="w">           </span><span class="m">2</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">0</span>.344167<span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">0</span>.363625<span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">0</span>.805833<span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">0</span>.160446<span class="w">  </span><span class="p">|</span><span class="w">         </span><span class="m">654</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="w">      </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">     </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">        </span><span class="m">0</span><span class="w">  </span><span class="p">|</span><span class="w">        </span><span class="m">0</span><span class="w">  </span><span class="p">|</span><span class="w">           </span><span class="m">0</span><span class="w">  </span><span class="p">|</span><span class="w">           </span><span class="m">2</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">0</span>.363478<span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">0</span>.353739<span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">0</span>.696087<span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">0</span>.248539<span class="w">  </span><span class="p">|</span><span class="w">         </span><span class="m">670</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="w">      </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">     </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">        </span><span class="m">0</span><span class="w">  </span><span class="p">|</span><span class="w">        </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">           </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">           </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">0</span>.196364<span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">0</span>.189405<span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">0</span>.437273<span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">0</span>.248309<span class="w">  </span><span class="p">|</span><span class="w">        </span><span class="m">1229</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="w">      </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">     </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">        </span><span class="m">0</span><span class="w">  </span><span class="p">|</span><span class="w">        </span><span class="m">2</span><span class="w">  </span><span class="p">|</span><span class="w">           </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">           </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">       </span><span class="m">0</span>.2<span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">0</span>.212122<span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">0</span>.590435<span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">0</span>.160296<span class="w">  </span><span class="p">|</span><span class="w">        </span><span class="m">1454</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="w">      </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">     </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">        </span><span class="m">0</span><span class="w">  </span><span class="p">|</span><span class="w">        </span><span class="m">3</span><span class="w">  </span><span class="p">|</span><span class="w">           </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">           </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">0</span>.226957<span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">0</span>.22927<span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">0</span>.436957<span class="w">  </span><span class="p">|</span><span class="w">     </span><span class="m">0</span>.1869<span class="w">  </span><span class="p">|</span><span class="w">        </span><span class="m">1518</span><span class="w">  </span><span class="p">|</span>
</span></code></pre></div>
<p>First, I’d like to see how features could be related to each other using a <strong>correlation matrix</strong>:</p>
<div class="language-groovy highlight"><span class="filename">correlation matrix</span><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="kt">def</span><span class="w"> </span><span class="n">plot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Underdog</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="w">    </span><span class="o">.</span><span class="na">plots</span><span class="o">()</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">    </span><span class="o">.</span><span class="na">correlationMatrix</span><span class="o">(</span><span class="n">df</span><span class="o">)</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="n">plot</span><span class="o">.</span><span class="na">show</span><span class="o">()</span>
</span></code></pre></div>
<figure>
<img alt="" src="../../images/linear_regression_notes/correlation_matrix.png#only-light" width="75%" />
<img alt="" src="../../images/linear_regression_notes/correlation_matrix_dark.png#only-dark" width="75%" />
</figure>
<p>There are a lot of features, but I’m focusing on just choosing one, <strong>temp</strong> which is the normalized temperature in Celsius 
the day of the rental. I’d like to see how it looks like visually the relationship between registered number of rentals 
(registered variable) and the temperature feature I’ve chosen:</p>
<div class="language-groovy highlight"><span class="filename">scatter matrix: temp vs registered</span><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="kt">def</span><span class="w"> </span><span class="n">plot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Underdog</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="w">    </span><span class="o">.</span><span class="na">plots</span><span class="o">()</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">    </span><span class="o">.</span><span class="na">scatterMatrix</span><span class="o">(</span><span class="n">df</span><span class="o">[</span><span class="s1">&#39;temp&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;registered&#39;</span><span class="o">])</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="n">plot</span><span class="o">.</span><span class="na">show</span><span class="o">()</span>
</span></code></pre></div>
<figure>
<img alt="" src="../../images/linear_regression_notes/pair_plot.png#only-light" width="60%" />
<img alt="" src="../../images/linear_regression_notes/pair_plot_dark.png#only-dark" width="60%" />
</figure>
<p>What I’m looking for at this point in the scatter plot, is tendencies. In this case it seems that points tend to go in diagonal from the bottom left to the upper right part of the graph. So far, the more tendency I see the better it seems to work. Now I'm creating a linear regression model using the <a href="https://en.wikipedia.org/wiki/Ordinary_least_squares">Ordinary least square</a> algorithm (OLS):</p>
<div class="language-groovy highlight"><span class="filename">linear regression</span><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c1">// features (X) and labels (y)</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="kt">def</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="o">[</span><span class="s1">&#39;temp&#39;</span><span class="o">]</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">double</span><span class="o">[][]</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="kt">def</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="o">[</span><span class="s1">&#39;registered&#39;</span><span class="o">]</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">double</span><span class="o">[]</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="kt">def</span><span class="w"> </span><span class="n">ml</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Underdog</span><span class="o">.</span><span class="na">ml</span><span class="o">()</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="c1">// train test split (0.75 training, 0.25 test)</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="kt">def</span><span class="w"> </span><span class="o">(</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="w">    </span><span class="n">xTrain</span><span class="o">,</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="w">    </span><span class="n">xTest</span><span class="o">,</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="w">    </span><span class="n">yTrain</span><span class="o">,</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="w">    </span><span class="n">yTest</span>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a><span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ml</span><span class="o">.</span><span class="na">utils</span><span class="o">.</span><span class="na">trainTestSplit</span><span class="o">(</span><span class="n">X</span><span class="o">,</span><span class="w"> </span><span class="n">y</span><span class="o">)</span>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a><span class="c1">// model creation and training</span>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a><span class="kt">def</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ml</span><span class="o">.</span><span class="na">regression</span><span class="o">.</span><span class="na">ols</span><span class="o">(</span><span class="n">xTrain</span><span class="o">,</span><span class="w"> </span><span class="n">yTrain</span><span class="o">)</span>
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a>
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a><span class="c1">// predicting and getting r2_score for training and test sets</span>
</span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a><span class="kt">def</span><span class="w"> </span><span class="n">scoreTrain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">model</span><span class="o">.</span><span class="na">score</span><span class="o">(</span><span class="n">xTrain</span><span class="o">,</span><span class="w"> </span><span class="n">yTrain</span><span class="o">).</span><span class="na">round</span><span class="o">(</span><span class="mi">6</span><span class="o">)</span>
</span><span id="__span-7-20"><a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a><span class="kt">def</span><span class="w"> </span><span class="n">scoreTest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">model</span><span class="o">.</span><span class="na">score</span><span class="o">(</span><span class="n">xTest</span><span class="o">,</span><span class="w"> </span><span class="n">yTest</span><span class="o">).</span><span class="na">round</span><span class="o">(</span><span class="mi">6</span><span class="o">)</span>
</span><span id="__span-7-21"><a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a>
</span><span id="__span-7-22"><a id="__codelineno-7-22" name="__codelineno-7-22" href="#__codelineno-7-22"></a><span class="n">print</span><span class="o">(</span><span class="s2">&quot;train: ${scoreTrain}, test: ${scoreTest}&quot;</span><span class="o">)</span>
</span></code></pre></div>
<div class="language-shell highlight"><span class="filename">output</span><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>train:<span class="w"> </span><span class="m">0</span>.307325,<span class="w"> </span>test:<span class="w"> </span><span class="m">0</span>.223381
</span></code></pre></div>
<p>If we draw the regression line we’ve got:</p>
<div class="language-groovy highlight"><span class="filename">scatter & line plot</span><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="kt">def</span><span class="w"> </span><span class="n">plt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Options</span><span class="o">.</span><span class="na">create</span><span class="w"> </span><span class="o">{</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="w">    </span><span class="n">title</span><span class="w"> </span><span class="o">{</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="w">        </span><span class="n">text</span><span class="o">(</span><span class="s1">&#39;Linear Regression (Least Squares - No Polynomial)&#39;</span><span class="o">)</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="w">        </span><span class="n">left</span><span class="o">(</span><span class="s1">&#39;center&#39;</span><span class="o">)</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="w">        </span><span class="n">top</span><span class="o">(</span><span class="s1">&#39;5%&#39;</span><span class="o">)</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="w">    </span><span class="o">}</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="w">    </span><span class="n">xAxis</span><span class="w"> </span><span class="o">{</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="w">        </span><span class="n">name</span><span class="o">(</span><span class="s1">&#39;temp&#39;</span><span class="o">)</span>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="w">        </span><span class="n">nameGap</span><span class="o">(</span><span class="mi">25</span><span class="o">)</span>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="w">        </span><span class="n">nameLocation</span><span class="o">(</span><span class="s1">&#39;center&#39;</span><span class="o">)</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="w">        </span><span class="n">show</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="w">    </span><span class="o">}</span>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="w">    </span><span class="n">yAxis</span><span class="w"> </span><span class="o">{</span>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="w">        </span><span class="n">name</span><span class="o">(</span><span class="s1">&#39;registered&#39;</span><span class="o">)</span>
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a><span class="w">        </span><span class="n">nameGap</span><span class="o">(</span><span class="mi">50</span><span class="o">)</span>
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a><span class="w">        </span><span class="n">nameLocation</span><span class="o">(</span><span class="s1">&#39;center&#39;</span><span class="o">)</span>
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a><span class="w">        </span><span class="n">show</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>
</span><span id="__span-9-18"><a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a><span class="w">    </span><span class="o">}</span>
</span><span id="__span-9-19"><a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a><span class="w">    </span><span class="c1">// SCATTER PLOT</span>
</span><span id="__span-9-20"><a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a><span class="w">    </span><span class="n">series</span><span class="o">(</span><span class="n">ScatterSeries</span><span class="o">){</span>
</span><span id="__span-9-21"><a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a><span class="w">        </span><span class="n">data</span><span class="o">(</span>
</span><span id="__span-9-22"><a id="__codelineno-9-22" name="__codelineno-9-22" href="#__codelineno-9-22"></a><span class="w">            </span><span class="n">toData</span><span class="o">(</span>
</span><span id="__span-9-23"><a id="__codelineno-9-23" name="__codelineno-9-23" href="#__codelineno-9-23"></a><span class="w">                </span><span class="n">xTest</span><span class="o">,</span><span class="w"> </span><span class="c1">// x1, x2,...xn</span>
</span><span id="__span-9-24"><a id="__codelineno-9-24" name="__codelineno-9-24" href="#__codelineno-9-24"></a><span class="w">                </span><span class="n">yTest</span><span class="w">  </span><span class="c1">// y1, y2,...yn</span>
</span><span id="__span-9-25"><a id="__codelineno-9-25" name="__codelineno-9-25" href="#__codelineno-9-25"></a><span class="w">            </span><span class="o">)</span><span class="w"> </span><span class="c1">// [[x1,y1], [x2,y2],...[xn, yn]]</span>
</span><span id="__span-9-26"><a id="__codelineno-9-26" name="__codelineno-9-26" href="#__codelineno-9-26"></a><span class="w">        </span><span class="o">)</span>
</span><span id="__span-9-27"><a id="__codelineno-9-27" name="__codelineno-9-27" href="#__codelineno-9-27"></a><span class="w">    </span><span class="o">}</span>
</span><span id="__span-9-28"><a id="__codelineno-9-28" name="__codelineno-9-28" href="#__codelineno-9-28"></a><span class="w">    </span><span class="c1">// REGRESSION LINE</span>
</span><span id="__span-9-29"><a id="__codelineno-9-29" name="__codelineno-9-29" href="#__codelineno-9-29"></a><span class="w">    </span><span class="n">series</span><span class="o">(</span><span class="n">LineSeries</span><span class="o">)</span><span class="w"> </span><span class="o">{</span>
</span><span id="__span-9-30"><a id="__codelineno-9-30" name="__codelineno-9-30" href="#__codelineno-9-30"></a><span class="w">        </span><span class="n">data</span><span class="o">(</span>
</span><span id="__span-9-31"><a id="__codelineno-9-31" name="__codelineno-9-31" href="#__codelineno-9-31"></a><span class="w">            </span><span class="n">toData</span><span class="o">(</span>
</span><span id="__span-9-32"><a id="__codelineno-9-32" name="__codelineno-9-32" href="#__codelineno-9-32"></a><span class="w">                </span><span class="n">xTest</span><span class="o">,</span>
</span><span id="__span-9-33"><a id="__codelineno-9-33" name="__codelineno-9-33" href="#__codelineno-9-33"></a><span class="w">                </span><span class="n">model</span><span class="o">.</span><span class="na">predict</span><span class="o">(</span><span class="n">xTest</span><span class="o">)</span>
</span><span id="__span-9-34"><a id="__codelineno-9-34" name="__codelineno-9-34" href="#__codelineno-9-34"></a><span class="w">            </span><span class="o">)</span>
</span><span id="__span-9-35"><a id="__codelineno-9-35" name="__codelineno-9-35" href="#__codelineno-9-35"></a><span class="w">        </span><span class="o">)</span>
</span><span id="__span-9-36"><a id="__codelineno-9-36" name="__codelineno-9-36" href="#__codelineno-9-36"></a><span class="w">    </span><span class="o">}</span>
</span><span id="__span-9-37"><a id="__codelineno-9-37" name="__codelineno-9-37" href="#__codelineno-9-37"></a><span class="o">}</span>
</span><span id="__span-9-38"><a id="__codelineno-9-38" name="__codelineno-9-38" href="#__codelineno-9-38"></a>
</span><span id="__span-9-39"><a id="__codelineno-9-39" name="__codelineno-9-39" href="#__codelineno-9-39"></a><span class="n">plt</span><span class="o">.</span><span class="na">show</span><span class="o">()</span>
</span></code></pre></div>
<figure>
<img alt="" src="../../images/linear_regression_notes/plot.png#only-light" width="60%" />
<img alt="" src="../../images/linear_regression_notes/plot_dark.png#only-dark" width="60%" />
</figure>
<p>A straight line won’t be able to do good predictions. A way of helping the linear transformation to adapt 
better to the shape of the model is to use a polynomial transformation.</p>
<h2 id="polynomial-transformation">Polynomial transformation</h2>
<p>When the problem doesn't fit easily a straight line or there are many features, it could become complicated to find a 
good relationship between them, specially with a simple line. The <strong>polynomial transformation</strong> helps finding those 
relationships. Applying a polynomial transformation to our problem can help the linear regression to adapt better to the 
shape of the data. This is the same linear regression example, but this time applying the <strong>polynomialFeatures</strong> function prior 
to the linear regression fit.</p>
<div class="language-groovy highlight"><span class="filename">applying polynomial transformation</span><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="c1">// transforming X adding new generated features</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="kt">def</span><span class="w"> </span><span class="n">xPoly</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ml</span><span class="o">.</span><span class="na">features</span><span class="o">.</span><span class="na">polynomialFeatures</span><span class="o">(</span><span class="n">X</span><span class="o">)</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="c1">// train test split (more data for training)</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="kt">def</span><span class="w"> </span><span class="o">(</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="w">    </span><span class="n">xTrain</span><span class="o">,</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="w">    </span><span class="n">xTest</span><span class="o">,</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="w">    </span><span class="n">yTrain</span><span class="o">,</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="w">    </span><span class="n">yTest</span>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ml</span><span class="o">.</span><span class="na">utils</span><span class="o">.</span><span class="na">trainTestSplit</span><span class="o">(</span><span class="n">xPoly</span><span class="o">,</span><span class="w"> </span><span class="n">y</span><span class="o">)</span>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="c1">// creating and training model</span>
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="kt">def</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ml</span><span class="o">.</span><span class="na">regression</span><span class="o">.</span><span class="na">ols</span><span class="o">(</span><span class="n">xTrain</span><span class="o">,</span><span class="w"> </span><span class="n">yTrain</span><span class="o">)</span>
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="c1">// predicting and getting r2_score for training and test sets</span>
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a><span class="kt">def</span><span class="w"> </span><span class="n">scoreTrain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">model</span><span class="o">.</span><span class="na">score</span><span class="o">(</span><span class="n">xTrain</span><span class="o">,</span><span class="w"> </span><span class="n">yTrain</span><span class="o">).</span><span class="na">round</span><span class="o">(</span><span class="mi">6</span><span class="o">)</span>
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a><span class="kt">def</span><span class="w"> </span><span class="n">scoreTest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">model</span><span class="o">.</span><span class="na">score</span><span class="o">(</span><span class="n">xTest</span><span class="o">,</span><span class="w"> </span><span class="n">yTest</span><span class="o">).</span><span class="na">round</span><span class="o">(</span><span class="mi">6</span><span class="o">)</span>
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a>
</span><span id="__span-10-19"><a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a><span class="n">print</span><span class="o">(</span><span class="s2">&quot;train: ${scoreTrain}, test: ${scoreTest}&quot;</span><span class="o">)</span>
</span></code></pre></div>
<div class="language-shell highlight"><span class="filename">output</span><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>train:<span class="w"> </span><span class="m">0</span>.355879,<span class="w"> </span>test:<span class="w"> </span><span class="m">0</span>.296751
</span></code></pre></div>
<p>Because the polynomial transformation is creating more features, they cover a wider spectrum of the data, therefore more 
likely to do improve accuracy, at least in the training dataset. If we draw now the result:</p>
<div class="language-groovy highlight"><span class="filename">linear regression polynomial plot</span><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c1">// building chart</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="kt">def</span><span class="w"> </span><span class="n">plt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Options</span><span class="o">.</span><span class="na">create</span><span class="w"> </span><span class="o">{</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="w">    </span><span class="n">title</span><span class="w"> </span><span class="o">{</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="w">        </span><span class="n">text</span><span class="o">(</span><span class="s1">&#39;Linear Regression (Least Squares - Polynomial)&#39;</span><span class="o">)</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="w">        </span><span class="n">left</span><span class="o">(</span><span class="s1">&#39;center&#39;</span><span class="o">)</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="w">        </span><span class="n">top</span><span class="o">(</span><span class="s1">&#39;5%&#39;</span><span class="o">)</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="w">    </span><span class="o">}</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="w">    </span><span class="n">xAxis</span><span class="w"> </span><span class="o">{</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="w">        </span><span class="n">name</span><span class="o">(</span><span class="s1">&#39;temp&#39;</span><span class="o">)</span>
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="w">        </span><span class="n">nameGap</span><span class="o">(</span><span class="mi">25</span><span class="o">)</span>
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="w">        </span><span class="n">nameLocation</span><span class="o">(</span><span class="s1">&#39;center&#39;</span><span class="o">)</span>
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a><span class="w">        </span><span class="n">show</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a><span class="w">    </span><span class="o">}</span>
</span><span id="__span-12-14"><a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a><span class="w">    </span><span class="n">yAxis</span><span class="w"> </span><span class="o">{</span>
</span><span id="__span-12-15"><a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a><span class="w">        </span><span class="n">name</span><span class="o">(</span><span class="s1">&#39;registered&#39;</span><span class="o">)</span>
</span><span id="__span-12-16"><a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a><span class="w">        </span><span class="n">nameGap</span><span class="o">(</span><span class="mi">50</span><span class="o">)</span>
</span><span id="__span-12-17"><a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a><span class="w">        </span><span class="n">nameLocation</span><span class="o">(</span><span class="s1">&#39;center&#39;</span><span class="o">)</span>
</span><span id="__span-12-18"><a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a><span class="w">        </span><span class="n">show</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>
</span><span id="__span-12-19"><a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a><span class="w">    </span><span class="o">}</span>
</span><span id="__span-12-20"><a id="__codelineno-12-20" name="__codelineno-12-20" href="#__codelineno-12-20"></a><span class="w">    </span><span class="c1">// SCATTER PLOT</span>
</span><span id="__span-12-21"><a id="__codelineno-12-21" name="__codelineno-12-21" href="#__codelineno-12-21"></a><span class="w">    </span><span class="n">series</span><span class="o">(</span><span class="n">ScatterSeries</span><span class="o">){</span>
</span><span id="__span-12-22"><a id="__codelineno-12-22" name="__codelineno-12-22" href="#__codelineno-12-22"></a><span class="w">        </span><span class="n">data</span><span class="o">(</span><span class="n">toData</span><span class="o">(</span><span class="n">X</span><span class="o">,</span><span class="w"> </span><span class="n">y</span><span class="o">))</span>
</span><span id="__span-12-23"><a id="__codelineno-12-23" name="__codelineno-12-23" href="#__codelineno-12-23"></a><span class="w">    </span><span class="o">}</span>
</span><span id="__span-12-24"><a id="__codelineno-12-24" name="__codelineno-12-24" href="#__codelineno-12-24"></a><span class="w">    </span><span class="c1">// REGRESSION LINES</span>
</span><span id="__span-12-25"><a id="__codelineno-12-25" name="__codelineno-12-25" href="#__codelineno-12-25"></a><span class="w">    </span><span class="kt">def</span><span class="w"> </span><span class="n">colors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="s1">&#39;gray&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;green&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;brown&#39;</span><span class="o">].</span><span class="na">indexed</span><span class="o">()</span>
</span><span id="__span-12-26"><a id="__codelineno-12-26" name="__codelineno-12-26" href="#__codelineno-12-26"></a>
</span><span id="__span-12-27"><a id="__codelineno-12-27" name="__codelineno-12-27" href="#__codelineno-12-27"></a><span class="w">    </span><span class="o">(</span><span class="mi">0</span><span class="o">..&lt;</span><span class="n">xTest</span><span class="o">.</span><span class="na">shape</span><span class="o">().</span><span class="na">cols</span><span class="o">).</span><span class="na">each</span><span class="w"> </span><span class="o">{</span><span class="n">feature</span><span class="w"> </span><span class="o">-&gt;</span>
</span><span id="__span-12-28"><a id="__codelineno-12-28" name="__codelineno-12-28" href="#__codelineno-12-28"></a><span class="w">        </span><span class="n">series</span><span class="o">(</span><span class="n">LineSeries</span><span class="o">)</span><span class="w"> </span><span class="o">{</span>
</span><span id="__span-12-29"><a id="__codelineno-12-29" name="__codelineno-12-29" href="#__codelineno-12-29"></a><span class="w">            </span><span class="n">smooth</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>
</span><span id="__span-12-30"><a id="__codelineno-12-30" name="__codelineno-12-30" href="#__codelineno-12-30"></a><span class="w">            </span><span class="n">itemStyle</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">color</span><span class="o">(</span><span class="n">colors</span><span class="o">[</span><span class="n">feature</span><span class="o">])</span><span class="w"> </span><span class="o">}</span>
</span><span id="__span-12-31"><a id="__codelineno-12-31" name="__codelineno-12-31" href="#__codelineno-12-31"></a><span class="w">            </span><span class="n">data</span><span class="o">(</span>
</span><span id="__span-12-32"><a id="__codelineno-12-32" name="__codelineno-12-32" href="#__codelineno-12-32"></a><span class="w">                </span><span class="n">toData</span><span class="o">(</span>
</span><span id="__span-12-33"><a id="__codelineno-12-33" name="__codelineno-12-33" href="#__codelineno-12-33"></a><span class="w">                    </span><span class="n">xTest</span><span class="o">.</span><span class="na">collect</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">it</span><span class="o">[</span><span class="n">feature</span><span class="o">]</span><span class="w"> </span><span class="o">},</span>
</span><span id="__span-12-34"><a id="__codelineno-12-34" name="__codelineno-12-34" href="#__codelineno-12-34"></a><span class="w">                    </span><span class="n">model</span><span class="o">.</span><span class="na">predict</span><span class="o">(</span><span class="n">xTest</span><span class="o">)</span>
</span><span id="__span-12-35"><a id="__codelineno-12-35" name="__codelineno-12-35" href="#__codelineno-12-35"></a><span class="w">                </span><span class="o">)</span>
</span><span id="__span-12-36"><a id="__codelineno-12-36" name="__codelineno-12-36" href="#__codelineno-12-36"></a><span class="w">            </span><span class="o">)</span>
</span><span id="__span-12-37"><a id="__codelineno-12-37" name="__codelineno-12-37" href="#__codelineno-12-37"></a><span class="w">        </span><span class="o">}</span>
</span><span id="__span-12-38"><a id="__codelineno-12-38" name="__codelineno-12-38" href="#__codelineno-12-38"></a>
</span><span id="__span-12-39"><a id="__codelineno-12-39" name="__codelineno-12-39" href="#__codelineno-12-39"></a><span class="w">    </span><span class="o">}</span>
</span><span id="__span-12-40"><a id="__codelineno-12-40" name="__codelineno-12-40" href="#__codelineno-12-40"></a><span class="o">}</span>
</span><span id="__span-12-41"><a id="__codelineno-12-41" name="__codelineno-12-41" href="#__codelineno-12-41"></a>
</span><span id="__span-12-42"><a id="__codelineno-12-42" name="__codelineno-12-42" href="#__codelineno-12-42"></a><span class="c1">// showing chart</span>
</span><span id="__span-12-43"><a id="__codelineno-12-43" name="__codelineno-12-43" href="#__codelineno-12-43"></a><span class="n">plt</span><span class="o">.</span><span class="na">show</span><span class="o">()</span>
</span></code></pre></div>
<figure>
<img alt="" src="../../images/linear_regression_notes/plot_polynomial.png#only-light" width="60%" />
<img alt="" src="../../images/linear_regression_notes/plot_polynomial_dark.png#only-dark" width="60%&quot;" />
</figure>
<p>Which covers much more than the previous example. However there are a couple of things to keep in mind when applying 
the polynomial transformation:</p>
<ul>
<li>Polynomial transformation with a high degree value could overfit the model</li>
<li>It’s better to combine it with a regularized regression method like Ridge.</li>
</ul>
<p>However so far it's clear that with just one feature we don't go anywhere as the models we've got so far barely work for training set and are useless for test sets. In regularization and normalization we will be using more features to try to create a viable model.</p>
<p><strong>References</strong></p>
<ul>
<li><a href="https://scikit-learn.org/1.5/auto_examples/linear_model/plot_polynomial_interpolation.html#sphx-glr-auto-examples-linear-model-plot-polynomial-interpolation-py">Polynomial interpolation</a></li>
<li><a href="https://scikit-learn.org/1.5/modules/generated/sklearn.preprocessing.PolynomialFeatures.html#sklearn.preprocessing.PolynomialFeatures">PolynomialFeatures in scikit-learn</a></li>
<li><a href="https://medium.com/@jonesntongana345/understanding-interaction-and-polynomial-features-in-pyspark-a-simple-guide-ef11f2e80eab">Understanding Polynomial Features (Medium)</a></li>
</ul>
<h2 id="feature-selection">Feature selection</h2>
<p>So far I’ve been working with just one feature temp to predict a possible outcome. I chose this feature by using the
correlation table as a guide. When looking for just one variable to work with, it could be enough, but when looking for
many possible features it could be cumbersome. </p>
<p><strong>Lasso regression</strong> could be one method for telling me <strong>which features
do perform and which don’t</strong>. How ? Well according to how the L1 regulation method works, keeping it short, those features
that are not so important, Lasso makes its coefficient equal to 0, therefore, <strong>those features having a coefficient
greater than 0 are worth using them to train the model (the higher the better)</strong>. Lets use this knowledge to know which
features could be useful to train the model.</p>
<p><div class="language-groovy highlight"><span class="filename">Lasso to get feature coefficients</span><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">underdog.Underdog</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">static</span><span class="w"> </span><span class="n">groovy</span><span class="o">.</span><span class="na">json</span><span class="o">.</span><span class="na">JsonOutput</span><span class="o">.</span><span class="na">toJson</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">static</span><span class="w"> </span><span class="n">groovy</span><span class="o">.</span><span class="na">json</span><span class="o">.</span><span class="na">JsonOutput</span><span class="o">.</span><span class="na">prettyPrint</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="c1">// taking all available features but the one for labelling</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="kt">def</span><span class="w"> </span><span class="n">featureNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="o">.</span><span class="na">columns</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="s2">&quot;registered&quot;</span>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a>
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="kt">def</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="o">[</span><span class="n">featureNames</span><span class="o">]</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">double</span><span class="o">[][]</span>
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="kt">def</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="o">[</span><span class="s1">&#39;registered&#39;</span><span class="o">]</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">double</span><span class="o">[]</span>
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a>
</span><span id="__span-13-12"><a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a><span class="c1">// creating and training model</span>
</span><span id="__span-13-13"><a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a><span class="kt">def</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Underdog</span><span class="o">.</span><span class="na">ml</span><span class="o">().</span><span class="na">regression</span><span class="o">.</span><span class="na">lasso</span><span class="o">(</span><span class="n">X</span><span class="o">,</span><span class="w"> </span><span class="n">y</span><span class="o">)</span>
</span><span id="__span-13-14"><a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a>
</span><span id="__span-13-15"><a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a><span class="c1">// extracting coefficients</span>
</span><span id="__span-13-16"><a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a><span class="kt">def</span><span class="w"> </span><span class="n">coefficients</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">model</span><span class="o">.</span><span class="na">coefficients</span><span class="o">()</span>
</span><span id="__span-13-17"><a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a><span class="kt">def</span><span class="w"> </span><span class="n">featNamesAndCoefficients</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">featureNames</span><span class="o">,</span><span class="w"> </span><span class="n">coefficients</span><span class="o">].</span><span class="na">transpose</span><span class="o">().</span><span class="na">collectEntries</span><span class="o">()</span>
</span><span id="__span-13-18"><a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a>
</span><span id="__span-13-19"><a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a><span class="n">println</span><span class="o">(</span><span class="n">prettyPrint</span><span class="o">(</span><span class="n">toJson</span><span class="o">(</span><span class="n">featNamesAndCoefficients</span><span class="o">)))</span>
</span></code></pre></div>
Which shows the following map:</p>
<p><div class="language-shell highlight"><span class="filename">features along with their coefficients</span><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="o">{</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="w">    </span><span class="s2">&quot;season&quot;</span>:<span class="w"> </span><span class="m">424</span>.11017152754937,
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="w">    </span><span class="s2">&quot;mnth&quot;</span>:<span class="w"> </span>-14.868338993584615,
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="w">    </span><span class="s2">&quot;holiday&quot;</span>:<span class="w"> </span>-211.17143310755654,
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="w">    </span><span class="s2">&quot;weekday&quot;</span>:<span class="w"> </span><span class="m">36</span>.06114879750305,
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="w">    </span><span class="s2">&quot;workingday&quot;</span>:<span class="w"> </span><span class="m">941</span>.7383145447468,
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="w">    </span><span class="s2">&quot;weathersit&quot;</span>:<span class="w"> </span>-397.9241830877648,
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="w">    </span><span class="s2">&quot;temp&quot;</span>:<span class="w"> </span><span class="m">1136</span>.7307642112696,
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="w">    </span><span class="s2">&quot;atemp&quot;</span>:<span class="w"> </span><span class="m">2730</span>.771127273043,
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="w">    </span><span class="s2">&quot;hum&quot;</span>:<span class="w"> </span>-1670.0999227731259,
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="w">    </span><span class="s2">&quot;windspeed&quot;</span>:<span class="w"> </span>-2200.526972819417
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a><span class="o">}</span>
</span></code></pre></div>
Now as the theory stated, we can discard those features with 0 value, and maybe those which are negatively correlated.
For this example, where I’m only interested in one feature to validate whether I chose the most significant feature or
not. In this case I’m getting the feature with the highest possitive coefficient:</p>
<div class="language-groovy highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="kt">def</span><span class="w"> </span><span class="n">bestFeatures</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">featNamesAndCoefficients</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="w">    </span><span class="o">.</span><span class="na">findAll</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">it</span><span class="o">.</span><span class="na">value</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">}</span><span class="w"> </span><span class="c1">// filtering all features w/ coefficient &gt; 0</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="w">    </span><span class="o">.</span><span class="na">sort</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="o">-</span><span class="n">it</span><span class="o">.</span><span class="na">value</span><span class="w"> </span><span class="o">}</span><span class="w"> </span><span class="c1">// sorting by coefficient (desc)</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="w">    </span><span class="o">*.</span><span class="na">key</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="c1">// getting feature names</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="n">println</span><span class="o">(</span><span class="n">bestFeatures</span><span class="o">)</span>
</span></code></pre></div>
<div class="language-shell highlight"><span class="filename">output</span><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="o">[</span><span class="s1">&#39;atemp&#39;</span>,<span class="w"> </span><span class="s1">&#39;temp&#39;</span>,<span class="w"> </span><span class="s1">&#39;workingday&#39;</span>,<span class="w"> </span><span class="s1">&#39;season&#39;</span>,<span class="w"> </span><span class="s1">&#39;weekday&#39;</span><span class="o">]</span>
</span></code></pre></div>
<h2 id="regularization-and-normalization">Regularization and normalization</h2>
<p><strong>Regularization</strong> is a technique used <strong>to reduce the model complexity</strong> and thus it helps dealing with over-fitting:</p>
<ul>
<li>It <strong>reduces the model size</strong> by shrinking the number of parameters the model has to learn </li>
<li>It <strong>adds weight to the values</strong> so that it tries to favor smaller values</li>
</ul>
<p>Regularization penalizes certain values by using a loss function with a cost. This cost could be of type:</p>
<ul>
<li><strong>L1</strong>: The cost is <strong>proportional to the absolute value</strong> of the weight coefficients (Lasso)</li>
<li><strong>L2</strong>: The cost is <strong>proportional to the square of the value</strong> of the weight coefficients (Ridge)</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Regularization really shines when there is a high dimensionality, meaning there’re multiple features. So in these 
examples it won’t make a huge impact with the scores.</p>
</div>
<p><strong>Data normalization</strong> is the <strong>process of rescaling one or more features to a common scale</strong>. It’s normally used when features used to create the model have different scales. There are a few advantages of using normalization is such scenario:</p>
<ul>
<li>It could improve the numerical stability of your model </li>
<li>It could speed up the training process</li>
</ul>
<p>Normalization is specially important when applying certain regression techniques, as regression is sensitive to 
model feature adjustments.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>When using only using ONE feature, normalization doesn't make much difference but, when 
using multiple features, and each of them in different scales, then we should use normalization.</p>
</div>
<h2 id="regularization-baseline">Regularization Baseline</h2>
<p>Lets do the simple linear regression again with the best features obtained from lasso regression coefficients to set
the baseline for the regularization &amp; normalization examples:</p>
<div class="language-groovy highlight"><span class="filename">Baseline</span><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="kt">def</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="o">[</span><span class="s1">&#39;atemp&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;temp&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;workingday&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;season&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;weekday&#39;</span><span class="o">]</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">double</span><span class="o">[][]</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="kt">def</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="o">[</span><span class="s1">&#39;registered&#39;</span><span class="o">]</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">double</span><span class="o">[]</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="kt">def</span><span class="w"> </span><span class="n">ml</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Underdog</span><span class="o">.</span><span class="na">ml</span><span class="o">()</span>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="c1">// train test split</span>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a><span class="kt">def</span><span class="w"> </span><span class="o">(</span><span class="n">xTrain</span><span class="o">,</span><span class="w"> </span><span class="n">xTest</span><span class="o">,</span><span class="w"> </span><span class="n">yTrain</span><span class="o">,</span><span class="w"> </span><span class="n">yTest</span><span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ml</span><span class="o">.</span><span class="na">utils</span><span class="o">.</span><span class="na">trainTestSplit</span><span class="o">(</span><span class="n">X</span><span class="o">,</span><span class="w"> </span><span class="n">y</span><span class="o">)</span>
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a><span class="c1">// creating and training model</span>
</span><span id="__span-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a><span class="kt">def</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ml</span><span class="o">.</span><span class="na">regression</span><span class="o">.</span><span class="na">ols</span><span class="o">(</span><span class="n">xTrain</span><span class="o">,</span><span class="w"> </span><span class="n">yTrain</span><span class="o">)</span>
</span><span id="__span-17-10"><a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a>
</span><span id="__span-17-11"><a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a><span class="c1">// getting scores</span>
</span><span id="__span-17-12"><a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a><span class="kt">def</span><span class="w"> </span><span class="n">scoreTrain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">model</span><span class="o">.</span><span class="na">score</span><span class="o">(</span><span class="n">xTrain</span><span class="o">,</span><span class="w"> </span><span class="n">yTrain</span><span class="o">).</span><span class="na">round</span><span class="o">(</span><span class="mi">6</span><span class="o">)</span>
</span><span id="__span-17-13"><a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a><span class="kt">def</span><span class="w"> </span><span class="n">scoreTest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">model</span><span class="o">.</span><span class="na">score</span><span class="o">(</span><span class="n">xTest</span><span class="o">,</span><span class="w"> </span><span class="n">yTest</span><span class="o">).</span><span class="na">round</span><span class="o">(</span><span class="mi">6</span><span class="o">)</span>
</span><span id="__span-17-14"><a id="__codelineno-17-14" name="__codelineno-17-14" href="#__codelineno-17-14"></a>
</span><span id="__span-17-15"><a id="__codelineno-17-15" name="__codelineno-17-15" href="#__codelineno-17-15"></a><span class="n">print</span><span class="o">(</span><span class="s2">&quot;train: ${scoreTrain}, test: ${scoreTest}&quot;</span><span class="o">)</span>
</span></code></pre></div>
<p>Obtaining the scores:</p>
<div class="language-shell highlight"><span class="filename">baseline scores</span><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>train:<span class="w"> </span><span class="m">0</span>.460528,<span class="w"> </span>test:<span class="w"> </span><span class="m">0</span>.311946
</span></code></pre></div>
<h2 id="ridge">Ridge</h2>
<ul>
<li>Follows the least-squares criterion but it <strong>uses regularization as a penalty</strong> for large variations in <strong>w</strong> parameters. </li>
<li>Regularization <strong>prevents over-fitting</strong> by restricting the model, it normally reduces its complexity </li>
<li>Regularization is controlled by the <strong>alpha parameter</strong> </li>
<li>The <strong>higher the value of alpha the simpler the model</strong>, that is, the model is less likely to over-fit</li>
</ul>
<p>Now I’m using Ridge class with the same dataset:</p>
<div class="language-groovy highlight"><span class="filename">using Ridge regression</span><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="kt">def</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="o">[</span><span class="s1">&#39;atemp&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;temp&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;workingday&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;season&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;weekday&#39;</span><span class="o">]</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">double</span><span class="o">[][]</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="kt">def</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="o">[</span><span class="s1">&#39;registered&#39;</span><span class="o">]</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">double</span><span class="o">[]</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="kt">def</span><span class="w"> </span><span class="n">ml</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Underdog</span><span class="o">.</span><span class="na">ml</span><span class="o">()</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="c1">// train test split (more data for training)</span>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="kt">def</span><span class="w"> </span><span class="o">(</span><span class="n">xTrain</span><span class="o">,</span><span class="w"> </span><span class="n">xTest</span><span class="o">,</span><span class="w"> </span><span class="n">yTrain</span><span class="o">,</span><span class="w"> </span><span class="n">yTest</span><span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ml</span><span class="o">.</span><span class="na">utils</span><span class="o">.</span><span class="na">trainTestSplit</span><span class="o">(</span><span class="n">X</span><span class="o">,</span><span class="w"> </span><span class="n">y</span><span class="o">)</span>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="c1">// creating and training model (RIDGE)</span>
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="kt">def</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ml</span><span class="o">.</span><span class="na">regression</span><span class="o">.</span><span class="na">ridge</span><span class="o">(</span><span class="n">xTrain</span><span class="o">,</span><span class="w"> </span><span class="n">yTrain</span><span class="o">,</span><span class="w"> </span><span class="nl">alpha:</span><span class="w"> </span><span class="mi">40</span><span class="o">)</span>
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a>
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a><span class="c1">// predicting and getting r2_score for training and test sets</span>
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a><span class="kt">def</span><span class="w"> </span><span class="n">scoreTrain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">model</span><span class="o">.</span><span class="na">score</span><span class="o">(</span><span class="n">xTrain</span><span class="o">,</span><span class="w"> </span><span class="n">yTrain</span><span class="o">).</span><span class="na">round</span><span class="o">(</span><span class="mi">6</span><span class="o">)</span>
</span><span id="__span-19-13"><a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a><span class="kt">def</span><span class="w"> </span><span class="n">scoreTest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">model</span><span class="o">.</span><span class="na">score</span><span class="o">(</span><span class="n">xTest</span><span class="o">,</span><span class="w"> </span><span class="n">yTest</span><span class="o">).</span><span class="na">round</span><span class="o">(</span><span class="mi">6</span><span class="o">)</span>
</span><span id="__span-19-14"><a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a>
</span><span id="__span-19-15"><a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a><span class="n">print</span><span class="o">(</span><span class="s2">&quot;train: ${scoreTrain}, test: ${scoreTest}&quot;</span><span class="o">)</span>
</span></code></pre></div>
<p>Giving me the following scores:</p>
<div class="language-shell highlight"><span class="filename">output</span><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>train:<span class="w"> </span><span class="m">0</span>.459691,<span class="w"> </span>test:<span class="w"> </span><span class="m">0</span>.321293
</span></code></pre></div>
<p>It looks better than the simple OLS example, the takeaway idea here is that the Ridge regression along with a 
high value of alpha is going to reduce the complexity of the model and <strong>make the generalization better</strong> (or at
least more stable).</p>
<p>Ridge regression score can be <strong>improved by applying normalization</strong> to the source dataset. Is important for some ML methods 
that all features are on the same scale. In this case we’re applying a MinMax normalization. However there’re some 
basic tips to be aware of:</p>
<ul>
<li><strong>Fit the scaler with the training set</strong> and then apply the same scaler to transform the training and test feature sets</li>
<li><strong>Don’t use the test dataset to fit the scaler</strong>. That could lead to data leakage.</li>
</ul>
<div class="language-groovy highlight"><span class="filename">Ridge with scaled set</span><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="kt">def</span><span class="w"> </span><span class="o">(</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="w">    </span><span class="n">xTrain</span><span class="o">,</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="w">    </span><span class="n">xTest</span><span class="o">,</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="w">    </span><span class="n">yTrain</span><span class="o">,</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="w">    </span><span class="n">yTest</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ml</span><span class="o">.</span><span class="na">utils</span><span class="o">.</span><span class="na">trainTestSplit</span><span class="o">(</span><span class="n">X</span><span class="o">,</span><span class="w"> </span><span class="n">y</span><span class="o">)</span>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="c1">// NORMALIZATION: training scaler with training set</span>
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="kt">def</span><span class="w"> </span><span class="n">minMaxTransformation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ml</span><span class="o">.</span><span class="na">features</span><span class="o">.</span><span class="na">minMaxScaler</span><span class="o">(</span><span class="n">xTrain</span><span class="o">)</span>
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a>
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a><span class="c1">// NORMALIZATION: transforming training set</span>
</span><span id="__span-21-12"><a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a><span class="kt">def</span><span class="w"> </span><span class="n">xTrainScaled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">minMaxTransformation</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">xTrain</span><span class="o">)</span>
</span><span id="__span-21-13"><a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a>
</span><span id="__span-21-14"><a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a><span class="c1">// NORMALIZATION: transforming testing set</span>
</span><span id="__span-21-15"><a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a><span class="kt">def</span><span class="w"> </span><span class="n">xTestScaled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">minMaxTransformation</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">xTest</span><span class="o">)</span>
</span><span id="__span-21-16"><a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a>
</span><span id="__span-21-17"><a id="__codelineno-21-17" name="__codelineno-21-17" href="#__codelineno-21-17"></a><span class="c1">// creating and training model</span>
</span><span id="__span-21-18"><a id="__codelineno-21-18" name="__codelineno-21-18" href="#__codelineno-21-18"></a><span class="kt">def</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ml</span><span class="o">.</span><span class="na">regression</span><span class="o">.</span><span class="na">ridge</span><span class="o">(</span><span class="n">xTrainScaled</span><span class="o">,</span><span class="w"> </span><span class="n">yTrain</span><span class="o">,</span><span class="w"> </span><span class="nl">alpha:</span><span class="w"> </span><span class="mi">40</span><span class="o">)</span>
</span><span id="__span-21-19"><a id="__codelineno-21-19" name="__codelineno-21-19" href="#__codelineno-21-19"></a>
</span><span id="__span-21-20"><a id="__codelineno-21-20" name="__codelineno-21-20" href="#__codelineno-21-20"></a><span class="c1">// predicting and getting r2_score for training and test sets</span>
</span><span id="__span-21-21"><a id="__codelineno-21-21" name="__codelineno-21-21" href="#__codelineno-21-21"></a><span class="kt">def</span><span class="w"> </span><span class="n">scoreTrain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">model</span><span class="o">.</span><span class="na">score</span><span class="o">(</span><span class="n">xTrainScaled</span><span class="o">,</span><span class="w"> </span><span class="n">yTrain</span><span class="o">).</span><span class="na">round</span><span class="o">(</span><span class="mi">6</span><span class="o">)</span>
</span><span id="__span-21-22"><a id="__codelineno-21-22" name="__codelineno-21-22" href="#__codelineno-21-22"></a><span class="kt">def</span><span class="w"> </span><span class="n">scoreTest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">model</span><span class="o">.</span><span class="na">score</span><span class="o">(</span><span class="n">xTestScaled</span><span class="o">,</span><span class="w"> </span><span class="n">yTest</span><span class="o">).</span><span class="na">round</span><span class="o">(</span><span class="mi">6</span><span class="o">)</span>
</span><span id="__span-21-23"><a id="__codelineno-21-23" name="__codelineno-21-23" href="#__codelineno-21-23"></a>
</span><span id="__span-21-24"><a id="__codelineno-21-24" name="__codelineno-21-24" href="#__codelineno-21-24"></a><span class="n">print</span><span class="o">(</span><span class="s2">&quot;train: ${scoreTrain}, test: ${scoreTest}&quot;</span><span class="o">)</span>
</span></code></pre></div>
<div class="language-shell highlight"><span class="filename">output</span><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>train:<span class="w"> </span><span class="m">0</span>.459691,<span class="w"> </span>test:<span class="w"> </span><span class="m">0</span>.321293
</span></code></pre></div>
<p>Well it didn't change a bit. I'm not sure whether is because the model is not that complex or the features don't change
much and the regularization + normalization doesn't add much either.</p>
<h2 id="lasso">Lasso</h2>
<ul>
<li>It uses a L1 type regularization penalty, meaning it minimizes the sum of the absolute values of the coefficients</li>
<li>It works as a kind of feature selection</li>
<li>It also has an alpha parameter to control regularization</li>
</ul>
<div class="language-groovy highlight"><span class="filename">using lasso regression</span><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="kt">def</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ml</span><span class="o">.</span><span class="na">regression</span><span class="o">.</span><span class="na">lasso</span><span class="o">(</span><span class="n">xTrain</span><span class="o">,</span><span class="w"> </span><span class="n">yTrain</span><span class="o">,</span><span class="w"> </span><span class="nl">alpha:</span><span class="w"> </span><span class="mi">40</span><span class="o">)</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="c1">// predicting and getting r2_score for training and test sets</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="kt">def</span><span class="w"> </span><span class="n">scoreTrain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">model</span><span class="o">.</span><span class="na">score</span><span class="o">(</span><span class="n">xTrain</span><span class="o">,</span><span class="w"> </span><span class="n">yTrain</span><span class="o">).</span><span class="na">round</span><span class="o">(</span><span class="mi">6</span><span class="o">)</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="kt">def</span><span class="w"> </span><span class="n">scoreTest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">model</span><span class="o">.</span><span class="na">score</span><span class="o">(</span><span class="n">xTest</span><span class="o">,</span><span class="w"> </span><span class="n">yTest</span><span class="o">).</span><span class="na">round</span><span class="o">(</span><span class="mi">6</span><span class="o">)</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="n">print</span><span class="o">(</span><span class="s2">&quot;train: ${scoreTrain}, test: ${scoreTest}&quot;</span><span class="o">)</span>
</span></code></pre></div>
<div class="language-shell highlight"><span class="filename">output</span><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>train:<span class="w"> </span><span class="m">0</span>.460528,<span class="w"> </span>test:<span class="w"> </span><span class="m">0</span>.31195
</span></code></pre></div>
<p>And finally using min-max scaler to try to improve regression scoring:</p>
<div class="language-groovy highlight"><span class="filename">lasso with scaled features</span><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="c1">// train test split</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="kt">def</span><span class="w"> </span><span class="o">(</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="w">        </span><span class="n">xTrain</span><span class="o">,</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="w">        </span><span class="n">xTest</span><span class="o">,</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="w">        </span><span class="n">yTrain</span><span class="o">,</span>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="w">        </span><span class="n">yTest</span>
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a><span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ml</span><span class="o">.</span><span class="na">utils</span><span class="o">.</span><span class="na">trainTestSplit</span><span class="o">(</span><span class="n">X</span><span class="o">,</span><span class="w"> </span><span class="n">y</span><span class="o">)</span>
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a>
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a><span class="c1">// normalization</span>
</span><span id="__span-25-10"><a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a><span class="kt">def</span><span class="w"> </span><span class="n">minMaxTransformation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ml</span><span class="o">.</span><span class="na">features</span><span class="o">.</span><span class="na">minMaxScaler</span><span class="o">(</span><span class="n">xTrain</span><span class="o">)</span>
</span><span id="__span-25-11"><a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a><span class="kt">def</span><span class="w"> </span><span class="n">xTrainScaled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">minMaxTransformation</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">xTrain</span><span class="o">)</span>
</span><span id="__span-25-12"><a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a><span class="kt">def</span><span class="w"> </span><span class="n">xTestScaled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">minMaxTransformation</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">xTest</span><span class="o">)</span>
</span><span id="__span-25-13"><a id="__codelineno-25-13" name="__codelineno-25-13" href="#__codelineno-25-13"></a>
</span><span id="__span-25-14"><a id="__codelineno-25-14" name="__codelineno-25-14" href="#__codelineno-25-14"></a><span class="c1">// creating and training model</span>
</span><span id="__span-25-15"><a id="__codelineno-25-15" name="__codelineno-25-15" href="#__codelineno-25-15"></a><span class="kt">def</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ml</span><span class="o">.</span><span class="na">regression</span><span class="o">.</span><span class="na">lasso</span><span class="o">(</span><span class="n">xTrainScaled</span><span class="o">,</span><span class="w"> </span><span class="n">yTrain</span><span class="o">,</span><span class="w"> </span><span class="nl">alpha:</span><span class="w"> </span><span class="mi">40</span><span class="o">)</span>
</span><span id="__span-25-16"><a id="__codelineno-25-16" name="__codelineno-25-16" href="#__codelineno-25-16"></a>
</span><span id="__span-25-17"><a id="__codelineno-25-17" name="__codelineno-25-17" href="#__codelineno-25-17"></a><span class="kt">def</span><span class="w"> </span><span class="n">scoreTrain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">model</span><span class="o">.</span><span class="na">score</span><span class="o">(</span><span class="n">xTrainScaled</span><span class="o">,</span><span class="w"> </span><span class="n">yTrain</span><span class="o">).</span><span class="na">round</span><span class="o">(</span><span class="mi">6</span><span class="o">)</span>
</span><span id="__span-25-18"><a id="__codelineno-25-18" name="__codelineno-25-18" href="#__codelineno-25-18"></a><span class="kt">def</span><span class="w"> </span><span class="n">scoreTest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">model</span><span class="o">.</span><span class="na">score</span><span class="o">(</span><span class="n">xTestScaled</span><span class="o">,</span><span class="w"> </span><span class="n">yTest</span><span class="o">).</span><span class="na">round</span><span class="o">(</span><span class="mi">6</span><span class="o">)</span>
</span><span id="__span-25-19"><a id="__codelineno-25-19" name="__codelineno-25-19" href="#__codelineno-25-19"></a>
</span><span id="__span-25-20"><a id="__codelineno-25-20" name="__codelineno-25-20" href="#__codelineno-25-20"></a><span class="n">print</span><span class="o">(</span><span class="s2">&quot;train: ${scoreTrain}, test: ${scoreTest}&quot;</span><span class="o">)</span>
</span></code></pre></div>
<div class="language-shell highlight"><span class="filename">output</span><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>train:<span class="w"> </span><span class="m">0</span>.460528,<span class="w"> </span>test:<span class="w"> </span><span class="m">0</span>.311954&gt;
</span></code></pre></div>
<p>Unfortunately this didn't improve the result either.</p>
<div class="admonition tip">
<p class="admonition-title">Ridge vs Lasso</p>
<p>In this case we’ve used both algorithms with the same dataset, but there’re situations where one or the other fit best:</p>
<ul>
<li>Ridge: Many small/medium sized effects</li>
<li>Lasso: Few medium/large sized effects</li>
</ul>
</div>
<h2 id="pca">PCA</h2>
<p>Principal component analysis (PCA) is an orthogonal linear transformation that transforms a number of possibly correlated variables into a smaller number of uncorrelated variables called principal components. Long story short tries to do the same model with less features involved <strong>doing a type of data compression</strong>. In this example we are trying to obtain similar results with one feature less using PCA:</p>
<div class="language-groovy highlight"><span class="filename">pca</span><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="c1">// train test split</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="kt">def</span><span class="w"> </span><span class="o">(</span>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="w">    </span><span class="n">xTrain</span><span class="o">,</span>
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="w">    </span><span class="n">xTest</span><span class="o">,</span>
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a><span class="w">    </span><span class="n">yTrain</span><span class="o">,</span>
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a><span class="w">    </span><span class="n">yTest</span>
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a><span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ml</span><span class="o">.</span><span class="na">utils</span><span class="o">.</span><span class="na">trainTestSplit</span><span class="o">(</span><span class="n">X</span><span class="o">,</span><span class="w"> </span><span class="n">y</span><span class="o">)</span>
</span><span id="__span-27-8"><a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a>
</span><span id="__span-27-9"><a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a><span class="c1">// normalization</span>
</span><span id="__span-27-10"><a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a><span class="kt">def</span><span class="w"> </span><span class="n">normalization</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ml</span><span class="o">.</span><span class="na">features</span><span class="o">.</span><span class="na">standardizeScaler</span><span class="o">(</span><span class="n">xTrain</span><span class="o">)</span>
</span><span id="__span-27-11"><a id="__codelineno-27-11" name="__codelineno-27-11" href="#__codelineno-27-11"></a><span class="c1">//      |</span>
</span><span id="__span-27-12"><a id="__codelineno-27-12" name="__codelineno-27-12" href="#__codelineno-27-12"></a><span class="c1">//      v</span>
</span><span id="__span-27-13"><a id="__codelineno-27-13" name="__codelineno-27-13" href="#__codelineno-27-13"></a><span class="kt">def</span><span class="w"> </span><span class="n">xTrainScaled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">normalization</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">xTrain</span><span class="o">)</span>
</span><span id="__span-27-14"><a id="__codelineno-27-14" name="__codelineno-27-14" href="#__codelineno-27-14"></a><span class="kt">def</span><span class="w"> </span><span class="n">xTestScaled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">normalization</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">xTest</span><span class="o">)</span>
</span><span id="__span-27-15"><a id="__codelineno-27-15" name="__codelineno-27-15" href="#__codelineno-27-15"></a>
</span><span id="__span-27-16"><a id="__codelineno-27-16" name="__codelineno-27-16" href="#__codelineno-27-16"></a><span class="c1">// compression</span>
</span><span id="__span-27-17"><a id="__codelineno-27-17" name="__codelineno-27-17" href="#__codelineno-27-17"></a><span class="kt">def</span><span class="w"> </span><span class="n">compression</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ml</span><span class="o">.</span><span class="na">features</span><span class="o">.</span><span class="na">pca</span><span class="o">(</span><span class="n">xTrainScaled</span><span class="o">,</span><span class="w"> </span><span class="mi">4</span><span class="o">)</span>
</span><span id="__span-27-18"><a id="__codelineno-27-18" name="__codelineno-27-18" href="#__codelineno-27-18"></a><span class="c1">//      |</span>
</span><span id="__span-27-19"><a id="__codelineno-27-19" name="__codelineno-27-19" href="#__codelineno-27-19"></a><span class="c1">//      v</span>
</span><span id="__span-27-20"><a id="__codelineno-27-20" name="__codelineno-27-20" href="#__codelineno-27-20"></a><span class="kt">def</span><span class="w"> </span><span class="n">xTrainScaledReduced</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">compression</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">xTrainScaled</span><span class="o">)</span>
</span><span id="__span-27-21"><a id="__codelineno-27-21" name="__codelineno-27-21" href="#__codelineno-27-21"></a><span class="kt">def</span><span class="w"> </span><span class="n">xTestScaledReduced</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">compression</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">xTestScaled</span><span class="o">)</span>
</span><span id="__span-27-22"><a id="__codelineno-27-22" name="__codelineno-27-22" href="#__codelineno-27-22"></a>
</span><span id="__span-27-23"><a id="__codelineno-27-23" name="__codelineno-27-23" href="#__codelineno-27-23"></a><span class="c1">// creating and training model</span>
</span><span id="__span-27-24"><a id="__codelineno-27-24" name="__codelineno-27-24" href="#__codelineno-27-24"></a><span class="kt">def</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ml</span><span class="o">.</span><span class="na">regression</span><span class="o">.</span><span class="na">ols</span><span class="o">(</span><span class="n">xTrainScaledReduced</span><span class="o">,</span><span class="w"> </span><span class="n">yTrain</span><span class="o">)</span>
</span><span id="__span-27-25"><a id="__codelineno-27-25" name="__codelineno-27-25" href="#__codelineno-27-25"></a>
</span><span id="__span-27-26"><a id="__codelineno-27-26" name="__codelineno-27-26" href="#__codelineno-27-26"></a><span class="c1">// predicting and getting r2_score for training and test sets</span>
</span><span id="__span-27-27"><a id="__codelineno-27-27" name="__codelineno-27-27" href="#__codelineno-27-27"></a><span class="kt">def</span><span class="w"> </span><span class="n">scoreTrain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">model</span><span class="o">.</span><span class="na">score</span><span class="o">(</span><span class="n">xTrainScaledReduced</span><span class="o">,</span><span class="w"> </span><span class="n">yTrain</span><span class="o">).</span><span class="na">round</span><span class="o">(</span><span class="mi">6</span><span class="o">)</span>
</span><span id="__span-27-28"><a id="__codelineno-27-28" name="__codelineno-27-28" href="#__codelineno-27-28"></a><span class="kt">def</span><span class="w"> </span><span class="n">scoreTest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">model</span><span class="o">.</span><span class="na">score</span><span class="o">(</span><span class="n">xTestScaledReduced</span><span class="o">,</span><span class="w"> </span><span class="n">yTest</span><span class="o">).</span><span class="na">round</span><span class="o">(</span><span class="mi">6</span><span class="o">)</span>
</span><span id="__span-27-29"><a id="__codelineno-27-29" name="__codelineno-27-29" href="#__codelineno-27-29"></a>
</span><span id="__span-27-30"><a id="__codelineno-27-30" name="__codelineno-27-30" href="#__codelineno-27-30"></a><span class="n">print</span><span class="o">(</span><span class="s2">&quot;train: ${scoreTrain}, test: ${scoreTest}&quot;</span><span class="o">)</span>
</span></code></pre></div>
<p>Which shows pretty the same results but reducing the data needed to train the data, which, may not be relevant in this example but it
could be a huge amount of data for some models.</p>
<div class="language-shell highlight"><span class="filename">output</span><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>train:<span class="w"> </span><span class="m">0</span>.460506,<span class="w"> </span>test:<span class="w"> </span><span class="m">0</span>.311325
</span></code></pre></div>







  
  




  



      
    </article>
  </div>

          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../../..", "features": ["content.code.copy", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.indexes", "toc.integrate", "navigation.top", "content.tabs.link"], "search": "../../../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
    
  </body>
</html>