
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://grooviter.github.io/underdog/dataframe/">
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../graphs/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>DataFrame - Underdog</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tutorial" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Underdog" class="md-header__button md-logo" aria-label="Underdog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Underdog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              DataFrame
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/grooviter/underdog" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Underdog

      </a>
    </li>
  

      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
    
  
  DataFrame

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../graphs/" class="md-tabs__link">
        
  
    
  
  Graphs

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../ml/" class="md-tabs__link">
        
  
    
  
  ML

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../plots/" class="md-tabs__link">
        
  
    
  
  Plots

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../ta/" class="md-tabs__link">
        
  
    
  
  Technical Analysis

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../development/" class="md-tabs__link">
        
  
    
  
  Development

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../blog/" class="md-tabs__link">
          
  
    
  
  Blog

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Underdog" class="md-nav__button md-logo" aria-label="Underdog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Underdog
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/grooviter/underdog" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Underdog
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    DataFrame
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    DataFrame
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tutorial" class="md-nav__link">
    <span class="md-ellipsis">
      Tutorial
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tutorial">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Prerequisites">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      Dependencies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data" class="md-nav__link">
    <span class="md-ellipsis">
      Data
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#loading-data" class="md-nav__link">
    <span class="md-ellipsis">
      Loading data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metadata" class="md-nav__link">
    <span class="md-ellipsis">
      Metadata
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#previewing" class="md-nav__link">
    <span class="md-ellipsis">
      Previewing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transforming" class="md-nav__link">
    <span class="md-ellipsis">
      Transforming
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sorting" class="md-nav__link">
    <span class="md-ellipsis">
      Sorting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#descriptive-statistics" class="md-nav__link">
    <span class="md-ellipsis">
      Descriptive statistics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filtering" class="md-nav__link">
    <span class="md-ellipsis">
      Filtering
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grouping" class="md-nav__link">
    <span class="md-ellipsis">
      Grouping
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cross-tabs" class="md-nav__link">
    <span class="md-ellipsis">
      Cross Tabs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#saving-your-data" class="md-nav__link">
    <span class="md-ellipsis">
      Saving your data
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      DataFrame
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DataFrame">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creation" class="md-nav__link">
    <span class="md-ellipsis">
      Creation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filtering_1" class="md-nav__link">
    <span class="md-ellipsis">
      Filtering
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Filtering">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#numbers" class="md-nav__link">
    <span class="md-ellipsis">
      Numbers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#string" class="md-nav__link">
    <span class="md-ellipsis">
      String
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dates" class="md-nav__link">
    <span class="md-ellipsis">
      Dates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#and" class="md-nav__link">
    <span class="md-ellipsis">
      &amp; and |
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sorting_1" class="md-nav__link">
    <span class="md-ellipsis">
      Sorting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapping" class="md-nav__link">
    <span class="md-ellipsis">
      Mapping
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#import-export" class="md-nav__link">
    <span class="md-ellipsis">
      Import / Export
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Import / Export">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#csv" class="md-nav__link">
    <span class="md-ellipsis">
      CSV
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CSV">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reading" class="md-nav__link">
    <span class="md-ellipsis">
      Reading
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#separator" class="md-nav__link">
    <span class="md-ellipsis">
      Separator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#duplicated-names" class="md-nav__link">
    <span class="md-ellipsis">
      Duplicated names
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#missing-values" class="md-nav__link">
    <span class="md-ellipsis">
      Missing values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#date-format" class="md-nav__link">
    <span class="md-ellipsis">
      Date format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skip-rowsfooter" class="md-nav__link">
    <span class="md-ellipsis">
      Skip rows/footer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#max-chars-x-col" class="md-nav__link">
    <span class="md-ellipsis">
      Max chars x col
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#max-cols" class="md-nav__link">
    <span class="md-ellipsis">
      Max cols
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#series" class="md-nav__link">
    <span class="md-ellipsis">
      Series
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Series">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#intro" class="md-nav__link">
    <span class="md-ellipsis">
      Intro
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating" class="md-nav__link">
    <span class="md-ellipsis">
      Creating
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#statistics" class="md-nav__link">
    <span class="md-ellipsis">
      Statistics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../graphs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Graphs
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../ml/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ML
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../plots/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plots
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../ta/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Technical Analysis
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../development/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Development
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../blog/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Blog
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8" id="__nav_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Blog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2" >
        
          
          <label class="md-nav__link" for="__nav_8_2" id="__nav_8_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Archive
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2">
            <span class="md-nav__icon md-icon"></span>
            Archive
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../blog/archive/2024/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2024
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_3" >
        
          
          <label class="md-nav__link" for="__nav_8_3" id="__nav_8_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Categories
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_3">
            <span class="md-nav__icon md-icon"></span>
            Categories
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../blog/category/ml/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ml
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>DataFrame</h1>

<p>Underdog's DataFrame combines tools for working with columnar data as tables (dataframes) and columns
(series). And also has extra features such statistical functions and visualizations via
Underdog's plots module.</p>
<h2 id="tutorial">Tutorial</h2>
<h3 id="prerequisites">Prerequisites</h3>
<h4 id="dependencies">Dependencies</h4>
<p>To be able to follow the tutorial you need the <code>underdog-dataframe</code> module. If you're using Gradle in your project:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:3"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><input id="__tabbed_1_3" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Gradle</label><label for="__tabbed_1_2">Maven</label><label for="__tabbed_1_3">Grapes</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-groovy highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">implementation</span><span class="w"> </span><span class="s2">&quot;com.github.grooviter:underdog-dataframe:VERSION&quot;</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-xml highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nt">&lt;dependency&gt;</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">    </span><span class="nt">&lt;groupId&gt;</span>com.github.grooviter<span class="nt">&lt;/groupId&gt;</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">    </span><span class="nt">&lt;artifactId&gt;</span>underdog-dataframe<span class="nt">&lt;/artifactId&gt;</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">    </span><span class="nt">&lt;version&gt;</span>VERSION<span class="nt">&lt;/version&gt;</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="nt">&lt;/dependency&gt;</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-groovy highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nd">@Grab</span><span class="o">(</span><span class="s2">&quot;com.github.grooviter:underdog-dataframe:VERSION&quot;</span><span class="o">)</span>
</span></code></pre></div>
</div>
</div>
</div>
<h4 id="data">Data</h4>
<p>You can find the data used in this tutorial <a href="https://github.com/grooviter/underdog/blob/main/docs/guide/src/test/resources/data/tornadoes_1950-2014.csv">here</a> </p>
<h3 id="loading-data">Loading data</h3>
<p>First of all we need to load the csv file with the data. Underdog infers the column types by sampling the data.</p>
<div class="language-groovy highlight"><span class="filename">reading</span><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">underdog.Underdog</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="kt">def</span><span class="w"> </span><span class="n">tornadoes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Underdog</span><span class="o">.</span><span class="na">df</span><span class="o">().</span><span class="na">read_csv</span><span class="o">(</span><span class="s2">&quot;src/test/resources/data/tornadoes_1950-2014.csv&quot;</span><span class="o">)</span>
</span></code></pre></div>
<p>Note the file, in this case, is addressed relative to the current working directory. In this case it must point to the csv file path whether it is a relative path of an absolute path.</p>
<h3 id="metadata">Metadata</h3>
<p>Often, the best way to start is to print the column names for reference:</p>
<div class="language-groovy highlight"><span class="filename">list dataframe column names</span><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">println</span><span class="w"> </span><span class="n">tornadoes</span><span class="o">.</span><span class="na">columns</span>
</span></code></pre></div>
<div class="language-text highlight"><span class="filename">output</span><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>[Date, Time, State, State No, Scale, Injuries, Fatalities, Start Lat, Start Lon, Length, Width]
</span></code></pre></div>
<p>The shape() method displays the row and column counts:</p>
<div class="language-groovy highlight"><span class="filename">.shape of the dataframe</span><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="kt">def</span><span class="w"> </span><span class="o">(</span><span class="kt">int</span><span class="w"> </span><span class="n">rows</span><span class="o">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">cols</span><span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tornadoes</span><span class="o">.</span><span class="na">shape</span><span class="o">()</span>
</span></code></pre></div>
<div class="language-groovy highlight"><span class="filename">shape of the dataframe</span><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">println</span><span class="w"> </span><span class="n">tornadoes</span><span class="o">.</span><span class="na">shape</span><span class="o">()</span>
</span></code></pre></div>
<div class="language-text highlight"><span class="filename">output</span><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>59945 rows X 11 cols
</span></code></pre></div>
<p>structure() shows the index, name and type of each column</p>
<div class="language-groovy highlight"><span class="filename">tornadoes schemas</span><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c1">// getting tornadoes schema</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="kt">def</span><span class="w"> </span><span class="n">schema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tornadoes</span><span class="o">.</span><span class="na">schema</span><span class="o">()</span>
</span></code></pre></div>
<div class="language-shell highlight"><span class="filename">output</span><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="w">  </span>Structure<span class="w"> </span>of<span class="w"> </span>tornadoes_1950-2014.csv
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="w"> </span>Index<span class="w">  </span><span class="p">|</span><span class="w">  </span>Column<span class="w"> </span>Name<span class="w">  </span><span class="p">|</span><span class="w">  </span>Column<span class="w"> </span>Type<span class="w">  </span><span class="p">|</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>-----------------------------------------
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="w">     </span><span class="m">0</span><span class="w">  </span><span class="p">|</span><span class="w">         </span>Date<span class="w">  </span><span class="p">|</span><span class="w">   </span>LOCAL_DATE<span class="w">  </span><span class="p">|</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="w">     </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">         </span>Time<span class="w">  </span><span class="p">|</span><span class="w">   </span>LOCAL_TIME<span class="w">  </span><span class="p">|</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="w">     </span><span class="m">2</span><span class="w">  </span><span class="p">|</span><span class="w">        </span>State<span class="w">  </span><span class="p">|</span><span class="w">       </span>STRING<span class="w">  </span><span class="p">|</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="w">     </span><span class="m">3</span><span class="w">  </span><span class="p">|</span><span class="w">     </span>State<span class="w"> </span>No<span class="w">  </span><span class="p">|</span><span class="w">      </span>INTEGER<span class="w">  </span><span class="p">|</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="w">     </span><span class="m">4</span><span class="w">  </span><span class="p">|</span><span class="w">        </span>Scale<span class="w">  </span><span class="p">|</span><span class="w">      </span>INTEGER<span class="w">  </span><span class="p">|</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="w">     </span><span class="m">5</span><span class="w">  </span><span class="p">|</span><span class="w">     </span>Injuries<span class="w">  </span><span class="p">|</span><span class="w">      </span>INTEGER<span class="w">  </span><span class="p">|</span>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="w">     </span><span class="m">6</span><span class="w">  </span><span class="p">|</span><span class="w">   </span>Fatalities<span class="w">  </span><span class="p">|</span><span class="w">      </span>INTEGER<span class="w">  </span><span class="p">|</span>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="w">     </span><span class="m">7</span><span class="w">  </span><span class="p">|</span><span class="w">    </span>Start<span class="w"> </span>Lat<span class="w">  </span><span class="p">|</span><span class="w">       </span>DOUBLE<span class="w">  </span><span class="p">|</span>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="w">     </span><span class="m">8</span><span class="w">  </span><span class="p">|</span><span class="w">    </span>Start<span class="w"> </span>Lon<span class="w">  </span><span class="p">|</span><span class="w">       </span>DOUBLE<span class="w">  </span><span class="p">|</span>
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="w">     </span><span class="m">9</span><span class="w">  </span><span class="p">|</span><span class="w">       </span>Length<span class="w">  </span><span class="p">|</span><span class="w">       </span>DOUBLE<span class="w">  </span><span class="p">|</span>
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a><span class="w">    </span><span class="m">10</span><span class="w">  </span><span class="p">|</span><span class="w">        </span>Width<span class="w">  </span><span class="p">|</span><span class="w">      </span>INTEGER<span class="w">  </span><span class="p">|</span>
</span></code></pre></div>
<p>Like many DataFrame methods, schema() returns another DataFrame. You can then produce a string representation for display. To display the DataFrame then, you can simply call.</p>
<div class="language-groovy highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="n">println</span><span class="w"> </span><span class="n">tornadoes</span>
</span></code></pre></div>
<p>You can also perform other DataFrame operations on the schema. For example, the code below removes all columns whose type isn’t <code>DOUBLE</code>:</p>
<div class="language-groovy highlight"><span class="filename">using schema to change dataframe structure</span><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="kt">def</span><span class="w"> </span><span class="n">customSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">schema</span><span class="o">[</span><span class="n">schema</span><span class="o">[</span><span class="s1">&#39;Column Type&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;DOUBLE&#39;</span><span class="o">]</span>
</span></code></pre></div>
<div class="language-shell highlight"><span class="filename">output</span><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="w">  </span>Structure<span class="w"> </span>of<span class="w"> </span>tornadoes_1950-2014.csv
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="w"> </span>Index<span class="w">  </span><span class="p">|</span><span class="w">  </span>Column<span class="w"> </span>Name<span class="w">  </span><span class="p">|</span><span class="w">  </span>Column<span class="w"> </span>Type<span class="w">  </span><span class="p">|</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>-----------------------------------------
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="w">     </span><span class="m">7</span><span class="w">  </span><span class="p">|</span><span class="w">    </span>Start<span class="w"> </span>Lat<span class="w">  </span><span class="p">|</span><span class="w">       </span>DOUBLE<span class="w">  </span><span class="p">|</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="w">     </span><span class="m">8</span><span class="w">  </span><span class="p">|</span><span class="w">    </span>Start<span class="w"> </span>Lon<span class="w">  </span><span class="p">|</span><span class="w">       </span>DOUBLE<span class="w">  </span><span class="p">|</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="w">     </span><span class="m">9</span><span class="w">  </span><span class="p">|</span><span class="w">       </span>Length<span class="w">  </span><span class="p">|</span><span class="w">       </span>DOUBLE<span class="w">  </span><span class="p">|</span>
</span></code></pre></div>
<p>Of course, that also returned another DataFrame. We’ll cover selecting rows in more detail later.</p>
<h3 id="previewing">Previewing</h3>
<p>The first(n) method returns a new DataFrame containing the first n rows.</p>
<div class="language-groovy highlight"><span class="filename">getting first 3 lines</span><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="n">tornadoes</span><span class="o">.</span><span class="na">head</span><span class="o">(</span><span class="mi">3</span><span class="o">)</span>
</span></code></pre></div>
<div class="language-shell highlight"><span class="filename">output</span><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="w">                                </span>tornadoes_1950-2014.csv
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="w">   </span>Date<span class="w">     </span><span class="p">|</span><span class="w">    </span>Time<span class="w">    </span><span class="p">|</span><span class="w">  </span>State<span class="w">  </span><span class="p">|</span><span class="w">  </span>State<span class="w"> </span>No<span class="w">  </span><span class="p">|</span><span class="w">  </span>Scale<span class="w">  </span><span class="p">|</span><span class="w">  </span>Injuries<span class="w">  </span><span class="p">|</span><span class="w">  </span>...<span class="w"> </span><span class="p">|</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>--------------------------------------------------------------------------------
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="m">1950</span>-01-03<span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">11</span>:00:00<span class="w">  </span><span class="p">|</span><span class="w">     </span>MO<span class="w">  </span><span class="p">|</span><span class="w">         </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="m">3</span><span class="w">  </span><span class="p">|</span><span class="w">         </span><span class="m">3</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>...<span class="w"> </span><span class="p">|</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="m">1950</span>-01-03<span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">11</span>:00:00<span class="w">  </span><span class="p">|</span><span class="w">     </span>MO<span class="w">  </span><span class="p">|</span><span class="w">         </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="m">3</span><span class="w">  </span><span class="p">|</span><span class="w">         </span><span class="m">3</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>...<span class="w"> </span><span class="p">|</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="m">1950</span>-01-03<span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">11</span>:10:00<span class="w">  </span><span class="p">|</span><span class="w">     </span>IL<span class="w">  </span><span class="p">|</span><span class="w">         </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="m">3</span><span class="w">  </span><span class="p">|</span><span class="w">         </span><span class="m">0</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>...<span class="w"> </span><span class="p">|</span>
</span></code></pre></div>
<h3 id="transforming">Transforming</h3>
<p>Mapping operations take one or more series (columns) as inputs and produce a new column as output. The method below extracts the Month name from the date column into a new column.</p>
<div class="language-groovy highlight"><span class="filename">creating a new series to dataframe</span><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="kt">def</span><span class="w"> </span><span class="n">monthSeries</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tornadoes</span><span class="o">[</span><span class="s2">&quot;Date&quot;</span><span class="o">](</span><span class="n">LocalDate</span><span class="o">,</span><span class="w"> </span><span class="n">String</span><span class="o">)</span><span class="w"> </span><span class="o">{</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="w">    </span><span class="n">it</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s2">&quot;MMMM&quot;</span><span class="o">)</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="o">}</span>
</span></code></pre></div>
<p>Now that you have a new column, you can add it to the DataFrame:</p>
<div class="language-groovy highlight"><span class="filename">adding month series to tornadoes dataframe</span><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="n">tornadoes</span><span class="o">[</span><span class="s1">&#39;month&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">monthSeries</span>
</span></code></pre></div>
<p>Of course nothing prevents you from doing everything altogether.</p>
<p>You can remove columns from DataFrames to save memory or reduce clutter:</p>
<div class="language-groovy highlight"><span class="filename">remove series from dataframe</span><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="n">tornadoes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tornadoes</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">tornadoes</span><span class="o">[</span><span class="s1">&#39;Date&#39;</span><span class="o">]</span>
</span></code></pre></div>
<h3 id="sorting">Sorting</h3>
<p>Now lets sort the DataFrame in reverse order by the id column. The negative sign before the name indicates a descending sort.</p>
<div class="language-groovy highlight"><span class="filename">sort asc</span><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="kt">def</span><span class="w"> </span><span class="n">df1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tornadoes</span><span class="o">.</span><span class="na">sort_values</span><span class="o">(</span><span class="nl">by:</span><span class="w"> </span><span class="s1">&#39;Fatalities&#39;</span><span class="o">)</span>
</span></code></pre></div>
<p>You can also sort in descending order:</p>
<div class="language-groovy highlight"><span class="filename">sort desc</span><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="kt">def</span><span class="w"> </span><span class="n">df2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tornadoes</span><span class="o">.</span><span class="na">sort_values</span><span class="o">(</span><span class="nl">by:</span><span class="w"> </span><span class="s1">&#39;-Fatalities&#39;</span><span class="o">)</span>
</span></code></pre></div>
<p>and even sorting by more than one field:</p>
<div class="language-groovy highlight"><span class="filename">sort by n-fields</span><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="kt">def</span><span class="w"> </span><span class="n">df3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tornadoes</span><span class="o">.</span><span class="na">sort_values</span><span class="o">(</span><span class="nl">by:</span><span class="w"> </span><span class="o">[</span><span class="s1">&#39;Fatalities&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;State&#39;</span><span class="o">])</span>
</span></code></pre></div>
<h3 id="descriptive-statistics">Descriptive statistics</h3>
<p>Descriptive statistics are calculated using the summary() method:</p>
<div class="language-groovy highlight"><span class="filename">printing column insights</span><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="kt">def</span><span class="w"> </span><span class="n">columnStats</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tornadoes</span><span class="o">[</span><span class="s2">&quot;Fatalities&quot;</span><span class="o">].</span><span class="na">describe</span><span class="o">()</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="n">println</span><span class="o">(</span><span class="n">columnStats</span><span class="o">)</span>
</span></code></pre></div>
<p>Showing the following output:</p>
<div class="language-shell highlight"><span class="filename">column describe output</span><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="w">         </span>Column:<span class="w"> </span>Fatalities
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="w"> </span>Measure<span class="w">   </span><span class="p">|</span><span class="w">         </span>Value<span class="w">         </span><span class="p">|</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>------------------------------------
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="w">        </span>n<span class="w">  </span><span class="p">|</span><span class="w">                </span><span class="m">59945</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="w">      </span>sum<span class="w">  </span><span class="p">|</span><span class="w">                 </span><span class="m">6802</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="w">     </span>Mean<span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">0</span>.11347068145800349<span class="w">  </span><span class="p">|</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="w">      </span>Min<span class="w">  </span><span class="p">|</span><span class="w">                    </span><span class="m">0</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="w">      </span>Max<span class="w">  </span><span class="p">|</span><span class="w">                  </span><span class="m">158</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a><span class="w">    </span>Range<span class="w">  </span><span class="p">|</span><span class="w">                  </span><span class="m">158</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a><span class="w"> </span>Variance<span class="w">  </span><span class="p">|</span><span class="w">    </span><span class="m">2</span>.901978053261765<span class="w">  </span><span class="p">|</span>
</span><span id="__span-23-11"><a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a><span class="w"> </span>Std.<span class="w"> </span>Dev<span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">1</span>.7035193140266314<span class="w">  </span><span class="p">|</span>
</span></code></pre></div>
<h3 id="filtering">Filtering</h3>
<p>The preferred way of filtering DataFrames in Underdog is to use the <strong>list notation</strong>. Look at the following example:</p>
<div class="language-groovy highlight"><span class="filename">filtering dataframe by column expressions</span><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="c1">// reading tornadoes</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="kt">def</span><span class="w"> </span><span class="n">ts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Underdog</span><span class="o">.</span><span class="na">df</span><span class="o">().</span><span class="na">read_csv</span><span class="o">(</span><span class="s2">&quot;src/test/resources/data/tornadoes_1950-2014.csv&quot;</span><span class="o">)</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="c1">// adding a new series to dataframe with the name of the month</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="n">ts</span><span class="o">[</span><span class="s1">&#39;month&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ts</span><span class="o">[</span><span class="s2">&quot;Date&quot;</span><span class="o">](</span><span class="n">LocalDate</span><span class="o">,</span><span class="w"> </span><span class="n">String</span><span class="o">)</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">it</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s2">&quot;MMMM&quot;</span><span class="o">)</span><span class="w"> </span><span class="o">}</span>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a>
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="c1">// filtering</span>
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a><span class="kt">def</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ts</span><span class="o">[</span>
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a><span class="w">    </span><span class="n">ts</span><span class="o">[</span><span class="s1">&#39;Fatalities&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;</span><span class="w">                   </span><span class="c1">// at least 1 fatalities</span>
</span><span id="__span-24-10"><a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a><span class="w">    </span><span class="n">ts</span><span class="o">[</span><span class="s1">&#39;month&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;April&quot;</span><span class="w"> </span><span class="o">&amp;</span><span class="w">                 </span><span class="c1">// in the month of April</span>
</span><span id="__span-24-11"><a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a><span class="w">    </span><span class="o">(</span><span class="n">ts</span><span class="o">[</span><span class="s1">&#39;Width&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">300</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ts</span><span class="o">[</span><span class="s1">&#39;Length&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10</span><span class="o">)</span><span class="w">  </span><span class="c1">// a tornado with a</span>
</span><span id="__span-24-12"><a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a><span class="o">]</span>
</span><span id="__span-24-13"><a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a>
</span><span id="__span-24-14"><a id="__codelineno-24-14" name="__codelineno-24-14" href="#__codelineno-24-14"></a><span class="c1">// selecting only two columns</span>
</span><span id="__span-24-15"><a id="__codelineno-24-15" name="__codelineno-24-15" href="#__codelineno-24-15"></a><span class="kt">def</span><span class="w"> </span><span class="n">stateAndDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">result</span><span class="o">[</span><span class="s1">&#39;State&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;Date&#39;</span><span class="o">]</span>
</span></code></pre></div>
<div class="language-shell highlight"><span class="filename">output</span><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="w"> </span>tornadoes_1950-2014.csv
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="w"> </span>State<span class="w">  </span><span class="p">|</span><span class="w">     </span>Date<span class="w">     </span><span class="p">|</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>------------------------
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="w">    </span>MO<span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">1950</span>-01-03<span class="w">  </span><span class="p">|</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="w">    </span>IL<span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">1950</span>-01-03<span class="w">  </span><span class="p">|</span>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="w">    </span>OH<span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">1950</span>-01-03<span class="w">  </span><span class="p">|</span>
</span></code></pre></div>
<p>The last example filters the tornadoes DataFrame with predicates of type <code>dataFrame[seriesName] op (series | object)</code>. Where <strong>op</strong> can be a comparison operators such as <code>&gt;=,&lt;=,==</code> etc. Of course these expressions can be combined with <code>or</code> or <code>and</code> operators <code>|</code> and <code>&amp;</code>. </p>
<h3 id="grouping">Grouping</h3>
<p>Series metrics can be calculated using grouping methods like sum(), product(), mean(), max(), etc.  You can apply those methods to a DataFrame, calculating results on one column, grouped by the values in another.</p>
<div class="language-groovy highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="kt">def</span><span class="w"> </span><span class="n">tornadoes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Underdog</span><span class="o">.</span><span class="na">df</span><span class="o">().</span><span class="na">read_csv</span><span class="o">(</span><span class="s2">&quot;src/test/resources/data/tornadoes_1950-2014.csv&quot;</span><span class="o">)</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="kt">def</span><span class="w"> </span><span class="n">injuriesByScale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tornadoes</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="w">    </span><span class="o">.</span><span class="na">rename</span><span class="o">(</span><span class="s2">&quot;Median Injuries by Tornado Scale&quot;</span><span class="o">)</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="w">    </span><span class="o">.</span><span class="na">agg</span><span class="o">(</span><span class="nl">Injuries:</span><span class="w"> </span><span class="s2">&quot;median&quot;</span><span class="o">)</span>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="w">    </span><span class="o">.</span><span class="na">by</span><span class="o">(</span><span class="s2">&quot;Scale&quot;</span><span class="o">)</span>
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a><span class="w">    </span><span class="o">.</span><span class="na">sort_values</span><span class="o">(</span><span class="nl">by:</span><span class="w"> </span><span class="s2">&quot;Scale&quot;</span><span class="o">)</span>
</span></code></pre></div>
<p>This produces the following DataFrame, in which Group represents the Tornado Scale and Median the median injures for that group:</p>
<div class="language-shell highlight"><span class="filename">output</span><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>Median<span class="w"> </span>injuries<span class="w"> </span>by<span class="w"> </span>Tornado<span class="w"> </span>Scale
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="w"> </span>Scale<span class="w">  </span><span class="p">|</span><span class="w">  </span>Median<span class="w"> </span><span class="o">[</span>Injuries<span class="o">]</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>-------------------------------
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="w">    </span>-9<span class="w">  </span><span class="p">|</span><span class="w">                  </span><span class="m">0</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a><span class="w">     </span><span class="m">0</span><span class="w">  </span><span class="p">|</span><span class="w">                  </span><span class="m">0</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a><span class="w">     </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">                  </span><span class="m">0</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a><span class="w">     </span><span class="m">2</span><span class="w">  </span><span class="p">|</span><span class="w">                  </span><span class="m">0</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-27-8"><a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a><span class="w">     </span><span class="m">3</span><span class="w">  </span><span class="p">|</span><span class="w">                  </span><span class="m">1</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-27-9"><a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a><span class="w">     </span><span class="m">4</span><span class="w">  </span><span class="p">|</span><span class="w">                 </span><span class="m">12</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-27-10"><a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a><span class="w">     </span><span class="m">5</span><span class="w">  </span><span class="p">|</span><span class="w">                </span><span class="m">107</span><span class="w">  </span><span class="p">|</span>
</span></code></pre></div>
<h3 id="cross-tabs">Cross Tabs</h3>
<p>Underdog lets you easily produce two-dimensional cross-tabulations (“cross tabs”) of counts and proportions with row and column subtotals. Here’s a count example where we look at the interaction of tornado severity and US state:</p>
<div class="language-groovy highlight"><span class="filename">crosstabs (count)</span><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="kt">def</span><span class="w"> </span><span class="n">crossTab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tornadoes</span><span class="o">.</span><span class="na">xTabCounts</span><span class="o">(</span><span class="nl">labels:</span><span class="w"> </span><span class="s1">&#39;State&#39;</span><span class="o">,</span><span class="w"> </span><span class="nl">values:</span><span class="w"> </span><span class="s1">&#39;Scale&#39;</span><span class="o">)</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="n">crossTab</span><span class="o">.</span><span class="na">head</span><span class="o">()</span>
</span></code></pre></div>
<div class="language-shell highlight"><span class="filename">output</span><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="w">                       </span>Crosstab<span class="w"> </span>Counts:<span class="w"> </span>State<span class="w"> </span>x<span class="w"> </span>Scale
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="w"> </span><span class="o">[</span>labels<span class="o">]</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>-9<span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">0</span><span class="w">    </span><span class="p">|</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="p">|</span><span class="w">   </span><span class="m">2</span><span class="w">   </span><span class="p">|</span><span class="w">   </span><span class="m">3</span><span class="w">   </span><span class="p">|</span><span class="w">  </span><span class="m">4</span><span class="w">   </span><span class="p">|</span><span class="w">  </span><span class="m">5</span><span class="w">   </span><span class="p">|</span><span class="w">  </span>total<span class="w">  </span><span class="p">|</span>
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a>----------------------------------------------------------------------------
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a><span class="w">       </span>AL<span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">0</span><span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">624</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">770</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">425</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">142</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">38</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">12</span><span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">2011</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a><span class="w">       </span>AR<span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">486</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">667</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">420</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">162</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">29</span><span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">0</span><span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">1765</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a><span class="w">       </span>AZ<span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">146</span><span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">71</span><span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">16</span><span class="w">  </span><span class="p">|</span><span class="w">    </span><span class="m">3</span><span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">0</span><span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">0</span><span class="w">  </span><span class="p">|</span><span class="w">    </span><span class="m">237</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-29-7"><a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a><span class="w">       </span>CA<span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">271</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">117</span><span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">23</span><span class="w">  </span><span class="p">|</span><span class="w">    </span><span class="m">2</span><span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">0</span><span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">0</span><span class="w">  </span><span class="p">|</span><span class="w">    </span><span class="m">414</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-29-8"><a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a><span class="w">       </span>CO<span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">3</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">1322</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">563</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">112</span><span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">22</span><span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">0</span><span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">2023</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-29-9"><a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a><span class="w">       </span>CT<span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">0</span><span class="w">  </span><span class="p">|</span><span class="w">    </span><span class="m">18</span><span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">53</span><span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">22</span><span class="w">  </span><span class="p">|</span><span class="w">    </span><span class="m">4</span><span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">2</span><span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">0</span><span class="w">  </span><span class="p">|</span><span class="w">     </span><span class="m">99</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-29-10"><a id="__codelineno-29-10" name="__codelineno-29-10" href="#__codelineno-29-10"></a><span class="w">       </span>DC<span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">0</span><span class="w">  </span><span class="p">|</span><span class="w">     </span><span class="m">2</span><span class="w">  </span><span class="p">|</span><span class="w">    </span><span class="m">0</span><span class="w">  </span><span class="p">|</span><span class="w">    </span><span class="m">0</span><span class="w">  </span><span class="p">|</span><span class="w">    </span><span class="m">0</span><span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">0</span><span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">0</span><span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="m">2</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-29-11"><a id="__codelineno-29-11" name="__codelineno-29-11" href="#__codelineno-29-11"></a><span class="w">       </span>DE<span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">0</span><span class="w">  </span><span class="p">|</span><span class="w">    </span><span class="m">22</span><span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">26</span><span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">12</span><span class="w">  </span><span class="p">|</span><span class="w">    </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">0</span><span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">0</span><span class="w">  </span><span class="p">|</span><span class="w">     </span><span class="m">61</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-29-12"><a id="__codelineno-29-12" name="__codelineno-29-12" href="#__codelineno-29-12"></a><span class="w">       </span>FL<span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">2</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">1938</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">912</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">319</span><span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">37</span><span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">3</span><span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">0</span><span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">3211</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-29-13"><a id="__codelineno-29-13" name="__codelineno-29-13" href="#__codelineno-29-13"></a><span class="w">       </span>GA<span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">0</span><span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">413</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">700</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">309</span><span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">74</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">11</span><span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">0</span><span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">1507</span><span class="w">  </span><span class="p">|</span>
</span></code></pre></div>
<p>Putting it all together</p>
<p>Now that you’ve seen the pieces, we can put them together to perform a more complex data analysis. Lets say we want to know how frequently Tornadoes occur in the summer. Here’’s one way to approach that:</p>
<p>Let’s start by getting only those tornadoes that occurred in the summer.</p>
<div class="language-groovy highlight"><span class="filename">tornadoes in the summer</span><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="kt">def</span><span class="w"> </span><span class="n">ts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Underdog</span><span class="o">.</span><span class="na">df</span><span class="o">().</span><span class="na">read_csv</span><span class="o">(</span><span class="s2">&quot;src/test/resources/data/tornadoes_1950-2014.csv&quot;</span><span class="o">)</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a><span class="c1">// adding some series to the dataframe to make filtering easier</span>
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a><span class="n">ts</span><span class="o">[</span><span class="s1">&#39;month&#39;</span><span class="o">]</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">ts</span><span class="o">[</span><span class="s1">&#39;Date&#39;</span><span class="o">](</span><span class="n">Date</span><span class="o">,</span><span class="w"> </span><span class="n">String</span><span class="o">)</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">it</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s2">&quot;MMMM&quot;</span><span class="o">)</span><span class="w"> </span><span class="o">}</span>
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a><span class="n">ts</span><span class="o">[</span><span class="s1">&#39;dayOfMonth&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ts</span><span class="o">[</span><span class="s1">&#39;Date&#39;</span><span class="o">](</span><span class="n">Date</span><span class="o">,</span><span class="w"> </span><span class="n">Integer</span><span class="o">)</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">it</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s2">&quot;dd&quot;</span><span class="o">).</span><span class="na">toInteger</span><span class="o">()</span><span class="w"> </span><span class="o">}</span>
</span><span id="__span-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a>
</span><span id="__span-30-7"><a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a><span class="c1">// filtering</span>
</span><span id="__span-30-8"><a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a><span class="kt">def</span><span class="w"> </span><span class="n">summer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ts</span><span class="o">[</span>
</span><span id="__span-30-9"><a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a><span class="w">    </span><span class="o">(</span><span class="n">ts</span><span class="o">[</span><span class="s1">&#39;month&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;June&#39;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">ts</span><span class="o">[</span><span class="s1">&#39;dayOfMonth&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">21</span><span class="o">)</span><span class="w"> </span><span class="o">|</span><span class="w">    </span><span class="c1">// after June the 21st or...</span>
</span><span id="__span-30-10"><a id="__codelineno-30-10" name="__codelineno-30-10" href="#__codelineno-30-10"></a><span class="w">    </span><span class="o">(</span><span class="n">ts</span><span class="o">[</span><span class="s1">&#39;month&#39;</span><span class="o">]</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="o">[</span><span class="s1">&#39;July&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;August&#39;</span><span class="o">])</span><span class="w"> </span><span class="o">|</span><span class="w">                </span><span class="c1">// in July or August or...</span>
</span><span id="__span-30-11"><a id="__codelineno-30-11" name="__codelineno-30-11" href="#__codelineno-30-11"></a><span class="w">    </span><span class="o">(</span><span class="n">ts</span><span class="o">[</span><span class="s1">&#39;month&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;September&#39;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">ts</span><span class="o">[</span><span class="s1">&#39;dayOfMonth&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">22</span><span class="o">)</span><span class="w"> </span><span class="c1">// before September the 22nd</span>
</span><span id="__span-30-12"><a id="__codelineno-30-12" name="__codelineno-30-12" href="#__codelineno-30-12"></a><span class="o">]</span>
</span></code></pre></div>
<p>Then to get the frequency:</p>
<ul>
<li>We calculate the difference in days between successive tornadoes. </li>
<li>The lag() method creates a column where every value equals the previous value (the prior row) of the source column. </li>
<li>Then we can simply get the difference in days between the two dates. DateColumn has a method daysUntil() that does this. It returns a NumberColumn that we’ll call “delta”.</li>
</ul>
<div class="language-groovy highlight"><span class="filename">lag and delta dates</span><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="c1">// sorting by Date and Time series</span>
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="n">summer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">summer</span><span class="o">.</span><span class="na">sort_values</span><span class="o">(</span><span class="nl">by:</span><span class="w"> </span><span class="o">[</span><span class="s1">&#39;Date&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;Time&#39;</span><span class="o">])</span>
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a>
</span><span id="__span-31-4"><a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a><span class="c1">// creating a series with lagged dates</span>
</span><span id="__span-31-5"><a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a><span class="n">summer</span><span class="o">[</span><span class="s1">&#39;Lagged&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">summer</span><span class="o">[</span><span class="s1">&#39;Date&#39;</span><span class="o">].</span><span class="na">lag</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
</span><span id="__span-31-6"><a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a>
</span><span id="__span-31-7"><a id="__codelineno-31-7" name="__codelineno-31-7" href="#__codelineno-31-7"></a><span class="c1">// creating a series with delta days between lagged dates and summer dates</span>
</span><span id="__span-31-8"><a id="__codelineno-31-8" name="__codelineno-31-8" href="#__codelineno-31-8"></a><span class="n">summer</span><span class="o">[</span><span class="s1">&#39;Delta&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">summer</span><span class="o">[</span><span class="s1">&#39;Lagged&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">summer</span><span class="o">[</span><span class="s1">&#39;Date&#39;</span><span class="o">]</span>
</span></code></pre></div>
<p>Now we simply calculate the mean of the delta column. Splitting on year keeps us from inadvertently including the time between the last tornado of one summer and the first tornado of the next.</p>
<div class="language-groovy highlight"><span class="filename">create summary</span><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="c1">// creating year series to be able to group by it</span>
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="n">summer</span><span class="o">[</span><span class="s1">&#39;year&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">summer</span><span class="o">[</span><span class="s1">&#39;Date&#39;</span><span class="o">](</span><span class="n">Date</span><span class="o">,</span><span class="w"> </span><span class="n">String</span><span class="o">)</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">it</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s2">&quot;YYYY&quot;</span><span class="o">)</span><span class="w"> </span><span class="o">}</span>
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a><span class="c1">// aggregating delta</span>
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a><span class="kt">def</span><span class="w"> </span><span class="n">summary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">summer</span><span class="o">.</span><span class="na">agg</span><span class="o">(</span><span class="nl">Delta:</span><span class="w"> </span><span class="o">[</span><span class="s2">&quot;mean&quot;</span><span class="o">,</span><span class="w"> </span><span class="s2">&quot;count&quot;</span><span class="o">]).</span><span class="na">by</span><span class="o">(</span><span class="s2">&quot;year&quot;</span><span class="o">)</span>
</span><span id="__span-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a>
</span><span id="__span-32-7"><a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a><span class="c1">// print out summary</span>
</span><span id="__span-32-8"><a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a><span class="n">println</span><span class="o">(</span><span class="n">summary</span><span class="o">)</span>
</span></code></pre></div>
<p>Printing summary gives us the answer by year.</p>
<div class="language-shell highlight"><span class="filename">summary output</span><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="w">                           </span>tornadoes_1950-2014.csv<span class="w"> </span>summary
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a><span class="w"> </span>Date<span class="w"> </span>year<span class="w">  </span><span class="p">|</span><span class="w">  </span>Mean<span class="w"> </span><span class="o">[</span>Date<span class="w"> </span>lag<span class="o">(</span><span class="m">1</span><span class="o">)</span><span class="w"> </span>-<span class="w"> </span>Date<span class="o">[</span>DAYS<span class="o">]]</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>Count<span class="w"> </span><span class="o">[</span>Date<span class="w"> </span>lag<span class="o">(</span><span class="m">1</span><span class="o">)</span><span class="w"> </span>-<span class="w"> </span>Date<span class="o">[</span>DAYS<span class="o">]]</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>--------------------------------------------------------------------------------------
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a><span class="w">      </span><span class="m">1950</span><span class="w">  </span><span class="p">|</span><span class="w">               </span><span class="m">2</span>.0555555555555545<span class="w">  </span><span class="p">|</span><span class="w">                               </span><span class="m">162</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a><span class="w">      </span><span class="m">1951</span><span class="w">  </span><span class="p">|</span><span class="w">               </span><span class="m">1</span>.7488584474885829<span class="w">  </span><span class="p">|</span><span class="w">                               </span><span class="m">219</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-33-6"><a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a><span class="w">      </span><span class="m">1952</span><span class="w">  </span><span class="p">|</span><span class="w">               </span><span class="m">1</span>.8673469387755088<span class="w">  </span><span class="p">|</span><span class="w">                               </span><span class="m">196</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-33-7"><a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a><span class="w">      </span><span class="m">1953</span><span class="w">  </span><span class="p">|</span><span class="w">                </span><span class="m">0</span>.983870967741935<span class="w">  </span><span class="p">|</span><span class="w">                               </span><span class="m">372</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-33-8"><a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a><span class="w">      </span><span class="m">1954</span><span class="w">  </span><span class="p">|</span><span class="w">               </span><span class="m">0</span>.8617283950617302<span class="w">  </span><span class="p">|</span><span class="w">                               </span><span class="m">405</span><span class="w">  </span><span class="p">|</span>
</span></code></pre></div>
<p>To get a DOUBLE for the entire period, we can take the average of the annual means.</p>
<div class="language-groovy highlight"><span class="filename">average second column</span><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="kt">def</span><span class="w"> </span><span class="n">meanOfSeries</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">summary</span><span class="o">.</span><span class="na">iloc</span><span class="o">[</span><span class="n">__</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="o">].</span><span class="na">mean</span><span class="o">()</span>
</span></code></pre></div>
<div class="language-text highlight"><span class="filename">Average days between tornadoes in the summer:</span><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>0.5931137164104612
</span></code></pre></div>
<h3 id="saving-your-data">Saving your data</h3>
<p>To save a DataFrame, you can write it as a CSV file:</p>
<div class="language-groovy highlight"><span class="filename">saving csv file</span><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="n">tornadoes</span><span class="o">.</span><span class="na">write</span><span class="o">().</span><span class="na">csv</span><span class="o">(</span><span class="s2">&quot;rev_tornadoes_1950-2014.csv&quot;</span><span class="o">);</span>
</span></code></pre></div>
<p>And that’s it for the introduction. Please see the User Guide for more information.</p>
<h2 id="dataframe">DataFrame</h2>
<p>Underdog's DataFrame combines tools for working with columnar data as tables (dataframes) and columns
(series). And also has extra features such statistical functions and visualizations via 
Underdog's plots module.</p>
<h3 id="creation">Creation</h3>
<p>The easiest way to create a Dataframe is using the Underdog extension method <code>Underdog.df()</code>. Here we're creating an empty DataFrame:</p>
<div class="language-groovy highlight"><span class="filename">empty dataframe</span><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="n">DataFrame</span><span class="w"> </span><span class="n">emptyDataFrame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Underdog</span><span class="o">.</span><span class="na">df</span><span class="o">().</span><span class="na">empty</span><span class="o">()</span>
</span></code></pre></div>
<p>We can create a dataframe with a series of map entries representing series. In this case the key entry is the name of the series and the value is a collection which will become the content of the series.</p>
<div class="language-groovy highlight"><span class="filename">dataframe from a map</span><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="c1">// creating a map</span>
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a><span class="kt">def</span><span class="w"> </span><span class="n">map</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span>
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a><span class="w">    </span><span class="nl">names:</span><span class="w"> </span><span class="o">[</span><span class="s2">&quot;John&quot;</span><span class="o">,</span><span class="w"> </span><span class="s2">&quot;Laura&quot;</span><span class="o">,</span><span class="w"> </span><span class="s2">&quot;Ursula&quot;</span><span class="o">],</span>
</span><span id="__span-38-4"><a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a><span class="w">    </span><span class="nl">ages:</span><span class="w"> </span><span class="o">[</span><span class="mi">22</span><span class="o">,</span><span class="w"> </span><span class="mi">34</span><span class="o">,</span><span class="w"> </span><span class="mi">83</span><span class="o">]</span>
</span><span id="__span-38-5"><a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a><span class="o">]</span>
</span><span id="__span-38-6"><a id="__codelineno-38-6" name="__codelineno-38-6" href="#__codelineno-38-6"></a>
</span><span id="__span-38-7"><a id="__codelineno-38-7" name="__codelineno-38-7" href="#__codelineno-38-7"></a><span class="c1">// creating a dataframe from the map</span>
</span><span id="__span-38-8"><a id="__codelineno-38-8" name="__codelineno-38-8" href="#__codelineno-38-8"></a><span class="n">DataFrame</span><span class="w"> </span><span class="n">map2DataFrame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Underdog</span><span class="o">.</span><span class="na">df</span><span class="o">().</span><span class="na">from</span><span class="o">(</span><span class="n">map</span><span class="o">,</span><span class="w"> </span><span class="s2">&quot;people-dataframe&quot;</span><span class="o">)</span>
</span></code></pre></div>
<div class="language-shell highlight"><span class="filename">output</span><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a>people-dataframe
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a><span class="w"> </span>name<span class="w">   </span><span class="p">|</span><span class="w">  </span>age<span class="w">  </span><span class="p">|</span>
</span><span id="__span-39-3"><a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a>------------------
</span><span id="__span-39-4"><a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a><span class="w">  </span>John<span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">22</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-39-5"><a id="__codelineno-39-5" name="__codelineno-39-5" href="#__codelineno-39-5"></a><span class="w"> </span>Laura<span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">34</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-39-6"><a id="__codelineno-39-6" name="__codelineno-39-6" href="#__codelineno-39-6"></a>Ursula<span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">83</span><span class="w">  </span><span class="p">|</span>
</span></code></pre></div>
<p>Underdog dataframe library adds additional methods to collection types so that you can convert from collections to Dataframes. And example is invoking the <code>toDataFrame(...)</code> method from the map directly:</p>
<div class="language-groovy highlight"><span class="filename">map extension</span><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="c1">// creating a map</span>
</span><span id="__span-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a><span class="kt">def</span><span class="w"> </span><span class="n">map</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span>
</span><span id="__span-40-3"><a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a><span class="w">    </span><span class="nl">names:</span><span class="w"> </span><span class="o">[</span><span class="s2">&quot;John&quot;</span><span class="o">,</span><span class="w"> </span><span class="s2">&quot;Laura&quot;</span><span class="o">,</span><span class="w"> </span><span class="s2">&quot;Ursula&quot;</span><span class="o">],</span>
</span><span id="__span-40-4"><a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a><span class="w">    </span><span class="nl">ages:</span><span class="w"> </span><span class="o">[</span><span class="mi">22</span><span class="o">,</span><span class="w"> </span><span class="mi">34</span><span class="o">,</span><span class="w"> </span><span class="mi">83</span><span class="o">]</span>
</span><span id="__span-40-5"><a id="__codelineno-40-5" name="__codelineno-40-5" href="#__codelineno-40-5"></a><span class="o">]</span>
</span><span id="__span-40-6"><a id="__codelineno-40-6" name="__codelineno-40-6" href="#__codelineno-40-6"></a>
</span><span id="__span-40-7"><a id="__codelineno-40-7" name="__codelineno-40-7" href="#__codelineno-40-7"></a><span class="c1">// creating a dataframe from a map</span>
</span><span id="__span-40-8"><a id="__codelineno-40-8" name="__codelineno-40-8" href="#__codelineno-40-8"></a><span class="n">DataFrame</span><span class="w"> </span><span class="n">map2DataFrame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">map</span><span class="o">.</span><span class="na">toDataFrame</span><span class="o">(</span><span class="s2">&quot;people-dataframe&quot;</span><span class="o">)</span>
</span></code></pre></div>
<p>You can also pass a list of maps to the <code>Underdog.df().from(col, name)</code> method. The method assumes all entries are maps with the same keys:</p>
<div class="language-groovy highlight"><span class="filename">collection of maps</span><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="c1">// creating a list of maps</span>
</span><span id="__span-41-2"><a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a><span class="kt">def</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span>
</span><span id="__span-41-3"><a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a><span class="w">    </span><span class="o">[</span><span class="nl">name:</span><span class="w"> </span><span class="s2">&quot;John&quot;</span><span class="o">,</span><span class="w"> </span><span class="nl">age:</span><span class="w"> </span><span class="mi">22</span><span class="o">],</span>
</span><span id="__span-41-4"><a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a><span class="w">    </span><span class="o">[</span><span class="nl">name:</span><span class="w"> </span><span class="s2">&quot;Laura&quot;</span><span class="o">,</span><span class="w"> </span><span class="nl">age:</span><span class="w"> </span><span class="mi">34</span><span class="o">],</span>
</span><span id="__span-41-5"><a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a><span class="w">    </span><span class="o">[</span><span class="nl">name:</span><span class="w"> </span><span class="s2">&quot;Ursula&quot;</span><span class="o">,</span><span class="w"> </span><span class="nl">age:</span><span class="w"> </span><span class="mi">83</span><span class="o">]</span>
</span><span id="__span-41-6"><a id="__codelineno-41-6" name="__codelineno-41-6" href="#__codelineno-41-6"></a><span class="o">]</span>
</span><span id="__span-41-7"><a id="__codelineno-41-7" name="__codelineno-41-7" href="#__codelineno-41-7"></a>
</span><span id="__span-41-8"><a id="__codelineno-41-8" name="__codelineno-41-8" href="#__codelineno-41-8"></a><span class="c1">// creating a dataframe from the list</span>
</span><span id="__span-41-9"><a id="__codelineno-41-9" name="__codelineno-41-9" href="#__codelineno-41-9"></a><span class="n">DataFrame</span><span class="w"> </span><span class="n">colOfMaps2DataFrame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Underdog</span><span class="o">.</span><span class="na">df</span><span class="o">().</span><span class="na">from</span><span class="o">(</span><span class="n">list</span><span class="o">,</span><span class="w"> </span><span class="s2">&quot;people-dataframe&quot;</span><span class="o">)</span>
</span></code></pre></div>
<div class="language-shell highlight"><span class="filename">output</span><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a>people-dataframe
</span><span id="__span-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a><span class="w"> </span>name<span class="w">   </span><span class="p">|</span><span class="w">  </span>age<span class="w">  </span><span class="p">|</span>
</span><span id="__span-42-3"><a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a>------------------
</span><span id="__span-42-4"><a id="__codelineno-42-4" name="__codelineno-42-4" href="#__codelineno-42-4"></a><span class="w">  </span>John<span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">22</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-42-5"><a id="__codelineno-42-5" name="__codelineno-42-5" href="#__codelineno-42-5"></a><span class="w"> </span>Laura<span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">34</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-42-6"><a id="__codelineno-42-6" name="__codelineno-42-6" href="#__codelineno-42-6"></a>Ursula<span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">83</span><span class="w">  </span><span class="p">|</span>
</span></code></pre></div>
<p>Here there is also an extension method for collections so that, <strong>IF</strong> your list complies to this structure you can call to the method <code>toDataFrame(name)</code> and create a DataFrame from that collection.</p>
<div class="language-groovy highlight"><span class="filename">collection extension</span><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a><span class="c1">// creating a list of maps</span>
</span><span id="__span-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a><span class="kt">def</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span>
</span><span id="__span-43-3"><a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a><span class="w">    </span><span class="o">[</span><span class="nl">name:</span><span class="w"> </span><span class="s2">&quot;John&quot;</span><span class="o">,</span><span class="w"> </span><span class="nl">age:</span><span class="w"> </span><span class="mi">22</span><span class="o">],</span>
</span><span id="__span-43-4"><a id="__codelineno-43-4" name="__codelineno-43-4" href="#__codelineno-43-4"></a><span class="w">    </span><span class="o">[</span><span class="nl">name:</span><span class="w"> </span><span class="s2">&quot;Laura&quot;</span><span class="o">,</span><span class="w"> </span><span class="nl">age:</span><span class="w"> </span><span class="mi">34</span><span class="o">],</span>
</span><span id="__span-43-5"><a id="__codelineno-43-5" name="__codelineno-43-5" href="#__codelineno-43-5"></a><span class="w">    </span><span class="o">[</span><span class="nl">name:</span><span class="w"> </span><span class="s2">&quot;Ursula&quot;</span><span class="o">,</span><span class="w"> </span><span class="nl">age:</span><span class="w"> </span><span class="mi">83</span><span class="o">]</span>
</span><span id="__span-43-6"><a id="__codelineno-43-6" name="__codelineno-43-6" href="#__codelineno-43-6"></a><span class="o">]</span>
</span><span id="__span-43-7"><a id="__codelineno-43-7" name="__codelineno-43-7" href="#__codelineno-43-7"></a>
</span><span id="__span-43-8"><a id="__codelineno-43-8" name="__codelineno-43-8" href="#__codelineno-43-8"></a><span class="c1">// creating a dataframe from the list</span>
</span><span id="__span-43-9"><a id="__codelineno-43-9" name="__codelineno-43-9" href="#__codelineno-43-9"></a><span class="n">DataFrame</span><span class="w"> </span><span class="n">colOfMaps2DataFrame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">list</span><span class="o">.</span><span class="na">toDataFrame</span><span class="o">(</span><span class="s2">&quot;people-dataframe&quot;</span><span class="o">)</span>
</span></code></pre></div>
<h3 id="filtering_1">Filtering</h3>
<p>In a dataframe you can filter data by any of the Series the dataframe has.</p>
<h4 id="numbers">Numbers</h4>
<p>The following example creates a hypothetical population progression in ten years:</p>
<div class="language-groovy highlight"><span class="filename">numbers</span><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="kt">def</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span>
</span><span id="__span-44-2"><a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a><span class="w">    </span><span class="nl">years:</span><span class="w"> </span><span class="o">(</span><span class="mi">1991</span><span class="o">..</span><span class="mi">2000</span><span class="o">),</span>
</span><span id="__span-44-3"><a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a><span class="w">    </span><span class="nl">population:</span><span class="w"> </span><span class="o">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">10</span><span class="o">).</span><span class="na">collect</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">}</span>
</span><span id="__span-44-4"><a id="__codelineno-44-4" name="__codelineno-44-4" href="#__codelineno-44-4"></a><span class="o">].</span><span class="na">toDataFrame</span><span class="o">(</span><span class="s2">&quot;population increase&quot;</span><span class="o">)</span>
</span></code></pre></div>
<div class="language-shell highlight"><span class="filename">output</span><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a><span class="w">  </span>population<span class="w"> </span>increase
</span><span id="__span-45-2"><a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a>years<span class="w">  </span><span class="p">|</span><span class="w">  </span>population<span class="w">  </span><span class="p">|</span>
</span><span id="__span-45-3"><a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a>------------------------
</span><span id="__span-45-4"><a id="__codelineno-45-4" name="__codelineno-45-4" href="#__codelineno-45-4"></a><span class="w"> </span><span class="m">1991</span><span class="w">  </span><span class="p">|</span><span class="w">        </span><span class="m">1000</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-45-5"><a id="__codelineno-45-5" name="__codelineno-45-5" href="#__codelineno-45-5"></a><span class="w"> </span><span class="m">1992</span><span class="w">  </span><span class="p">|</span><span class="w">        </span><span class="m">2000</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-45-6"><a id="__codelineno-45-6" name="__codelineno-45-6" href="#__codelineno-45-6"></a><span class="w"> </span><span class="m">1993</span><span class="w">  </span><span class="p">|</span><span class="w">        </span><span class="m">3000</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-45-7"><a id="__codelineno-45-7" name="__codelineno-45-7" href="#__codelineno-45-7"></a><span class="w"> </span><span class="m">1994</span><span class="w">  </span><span class="p">|</span><span class="w">        </span><span class="m">4000</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-45-8"><a id="__codelineno-45-8" name="__codelineno-45-8" href="#__codelineno-45-8"></a><span class="w"> </span><span class="m">1995</span><span class="w">  </span><span class="p">|</span><span class="w">        </span><span class="m">5000</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-45-9"><a id="__codelineno-45-9" name="__codelineno-45-9" href="#__codelineno-45-9"></a><span class="w"> </span><span class="m">1996</span><span class="w">  </span><span class="p">|</span><span class="w">        </span><span class="m">6000</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-45-10"><a id="__codelineno-45-10" name="__codelineno-45-10" href="#__codelineno-45-10"></a><span class="w"> </span><span class="m">1997</span><span class="w">  </span><span class="p">|</span><span class="w">        </span><span class="m">7000</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-45-11"><a id="__codelineno-45-11" name="__codelineno-45-11" href="#__codelineno-45-11"></a><span class="w"> </span><span class="m">1998</span><span class="w">  </span><span class="p">|</span><span class="w">        </span><span class="m">8000</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-45-12"><a id="__codelineno-45-12" name="__codelineno-45-12" href="#__codelineno-45-12"></a><span class="w"> </span><span class="m">1999</span><span class="w">  </span><span class="p">|</span><span class="w">        </span><span class="m">9000</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-45-13"><a id="__codelineno-45-13" name="__codelineno-45-13" href="#__codelineno-45-13"></a><span class="w"> </span><span class="m">2000</span><span class="w">  </span><span class="p">|</span><span class="w">       </span><span class="m">10000</span><span class="w">  </span><span class="p">|</span>
</span></code></pre></div>
<p>If we wanted to take the records after year 1995:</p>
<div class="language-groovy highlight"><span class="filename">greater than</span><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a><span class="kt">def</span><span class="w"> </span><span class="n">last5Years</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="o">[</span><span class="n">df</span><span class="o">[</span><span class="s1">&#39;years&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1995</span><span class="o">]</span>
</span></code></pre></div>
<div class="language-shell highlight"><span class="filename">output</span><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a><span class="w">  </span>population<span class="w"> </span>increase
</span><span id="__span-47-2"><a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a>years<span class="w">  </span><span class="p">|</span><span class="w">  </span>population<span class="w">  </span><span class="p">|</span>
</span><span id="__span-47-3"><a id="__codelineno-47-3" name="__codelineno-47-3" href="#__codelineno-47-3"></a>------------------------
</span><span id="__span-47-4"><a id="__codelineno-47-4" name="__codelineno-47-4" href="#__codelineno-47-4"></a><span class="w"> </span><span class="m">1996</span><span class="w">  </span><span class="p">|</span><span class="w">        </span><span class="m">6000</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-47-5"><a id="__codelineno-47-5" name="__codelineno-47-5" href="#__codelineno-47-5"></a><span class="w"> </span><span class="m">1997</span><span class="w">  </span><span class="p">|</span><span class="w">        </span><span class="m">7000</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-47-6"><a id="__codelineno-47-6" name="__codelineno-47-6" href="#__codelineno-47-6"></a><span class="w"> </span><span class="m">1998</span><span class="w">  </span><span class="p">|</span><span class="w">        </span><span class="m">8000</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-47-7"><a id="__codelineno-47-7" name="__codelineno-47-7" href="#__codelineno-47-7"></a><span class="w"> </span><span class="m">1999</span><span class="w">  </span><span class="p">|</span><span class="w">        </span><span class="m">9000</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-47-8"><a id="__codelineno-47-8" name="__codelineno-47-8" href="#__codelineno-47-8"></a><span class="w"> </span><span class="m">2000</span><span class="w">  </span><span class="p">|</span><span class="w">       </span><span class="m">10000</span><span class="w">  </span><span class="p">|</span>
</span></code></pre></div>
<p>Or getting records with population less than 4000:</p>
<div class="language-groovy highlight"><span class="filename">less than</span><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="kt">def</span><span class="w"> </span><span class="n">yearsWithLessThan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="o">[</span><span class="n">df</span><span class="o">[</span><span class="s1">&#39;population&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">4000</span><span class="o">]</span>
</span></code></pre></div>
<div class="language-shell highlight"><span class="filename">output</span><pre><span></span><code><span id="__span-49-1"><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a>population<span class="w"> </span>increase
</span><span id="__span-49-2"><a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a>years<span class="w">  </span><span class="p">|</span><span class="w">  </span>population<span class="w">  </span><span class="p">|</span>
</span><span id="__span-49-3"><a id="__codelineno-49-3" name="__codelineno-49-3" href="#__codelineno-49-3"></a>------------------------
</span><span id="__span-49-4"><a id="__codelineno-49-4" name="__codelineno-49-4" href="#__codelineno-49-4"></a><span class="w"> </span><span class="m">1991</span><span class="w">  </span><span class="p">|</span><span class="w">        </span><span class="m">1000</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-49-5"><a id="__codelineno-49-5" name="__codelineno-49-5" href="#__codelineno-49-5"></a><span class="w"> </span><span class="m">1992</span><span class="w">  </span><span class="p">|</span><span class="w">        </span><span class="m">2000</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-49-6"><a id="__codelineno-49-6" name="__codelineno-49-6" href="#__codelineno-49-6"></a><span class="w"> </span><span class="m">1993</span><span class="w">  </span><span class="p">|</span><span class="w">        </span><span class="m">3000</span><span class="w">  </span><span class="p">|</span>
</span></code></pre></div>
<h4 id="string">String</h4>
<p>Of course we can filter by strings. Follow up we've got a dataframe with some employee data:</p>
<div class="language-groovy highlight"><span class="filename">employees</span><pre><span></span><code><span id="__span-50-1"><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a><span class="kt">def</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span>
</span><span id="__span-50-2"><a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a><span class="w">    </span><span class="nl">employees:</span><span class="w"> </span><span class="o">[</span><span class="s1">&#39;Udo&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;John&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;Albert&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;Ronda&#39;</span><span class="o">],</span>
</span><span id="__span-50-3"><a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a><span class="w">    </span><span class="nl">department:</span><span class="w"> </span><span class="o">[</span><span class="s1">&#39;sales&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;it&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;sales&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;it&#39;</span><span class="o">],</span>
</span><span id="__span-50-4"><a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a><span class="w">    </span><span class="nl">payroll:</span><span class="w"> </span><span class="o">[</span><span class="mi">10</span><span class="n">_000</span><span class="o">,</span><span class="w"> </span><span class="mi">12</span><span class="n">_000</span><span class="o">,</span><span class="w"> </span><span class="mi">11</span><span class="n">_000</span><span class="o">,</span><span class="w"> </span><span class="mi">13</span><span class="n">_000</span><span class="o">]</span>
</span><span id="__span-50-5"><a id="__codelineno-50-5" name="__codelineno-50-5" href="#__codelineno-50-5"></a><span class="o">].</span><span class="na">toDataFrame</span><span class="o">(</span><span class="s2">&quot;employees&quot;</span><span class="o">)</span>
</span></code></pre></div>
<div class="language-shell highlight"><span class="filename">output</span><pre><span></span><code><span id="__span-51-1"><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a><span class="w">               </span>employees
</span><span id="__span-51-2"><a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a><span class="w"> </span>employees<span class="w">  </span><span class="p">|</span><span class="w">  </span>department<span class="w">  </span><span class="p">|</span><span class="w">  </span>payroll<span class="w">  </span><span class="p">|</span>
</span><span id="__span-51-3"><a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a>----------------------------------------
</span><span id="__span-51-4"><a id="__codelineno-51-4" name="__codelineno-51-4" href="#__codelineno-51-4"></a><span class="w">       </span>Udo<span class="w">  </span><span class="p">|</span><span class="w">       </span>sales<span class="w">  </span><span class="p">|</span><span class="w">    </span><span class="m">10000</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-51-5"><a id="__codelineno-51-5" name="__codelineno-51-5" href="#__codelineno-51-5"></a><span class="w">      </span>John<span class="w">  </span><span class="p">|</span><span class="w">          </span>it<span class="w">  </span><span class="p">|</span><span class="w">    </span><span class="m">12000</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-51-6"><a id="__codelineno-51-6" name="__codelineno-51-6" href="#__codelineno-51-6"></a><span class="w">    </span>Albert<span class="w">  </span><span class="p">|</span><span class="w">       </span>sales<span class="w">  </span><span class="p">|</span><span class="w">    </span><span class="m">11000</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-51-7"><a id="__codelineno-51-7" name="__codelineno-51-7" href="#__codelineno-51-7"></a><span class="w">     </span>Ronda<span class="w">  </span><span class="p">|</span><span class="w">          </span>it<span class="w">  </span><span class="p">|</span><span class="w">    </span><span class="m">13000</span><span class="w">  </span><span class="p">|</span>
</span></code></pre></div>
<p>Getting employees from sales department:</p>
<div class="language-groovy highlight"><span class="filename">sales</span><pre><span></span><code><span id="__span-52-1"><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a><span class="kt">def</span><span class="w"> </span><span class="n">salesPeople</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="o">[</span><span class="n">df</span><span class="o">[</span><span class="s1">&#39;department&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;sales&#39;</span><span class="o">]</span>
</span></code></pre></div>
<div class="language-shell highlight"><span class="filename">output</span><pre><span></span><code><span id="__span-53-1"><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a><span class="w">               </span>employees
</span><span id="__span-53-2"><a id="__codelineno-53-2" name="__codelineno-53-2" href="#__codelineno-53-2"></a><span class="w"> </span>employees<span class="w">  </span><span class="p">|</span><span class="w">  </span>department<span class="w">  </span><span class="p">|</span><span class="w">  </span>payroll<span class="w">  </span><span class="p">|</span>
</span><span id="__span-53-3"><a id="__codelineno-53-3" name="__codelineno-53-3" href="#__codelineno-53-3"></a>----------------------------------------
</span><span id="__span-53-4"><a id="__codelineno-53-4" name="__codelineno-53-4" href="#__codelineno-53-4"></a><span class="w">       </span>Udo<span class="w">  </span><span class="p">|</span><span class="w">       </span>sales<span class="w">  </span><span class="p">|</span><span class="w">    </span><span class="m">10000</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-53-5"><a id="__codelineno-53-5" name="__codelineno-53-5" href="#__codelineno-53-5"></a><span class="w">    </span>Albert<span class="w">  </span><span class="p">|</span><span class="w">       </span>sales<span class="w">  </span><span class="p">|</span><span class="w">    </span><span class="m">11000</span><span class="w">  </span><span class="p">|</span>
</span></code></pre></div>
<p>You can also use to filter by a list of possible choices:</p>
<div class="language-groovy highlight"><span class="filename">in list</span><pre><span></span><code><span id="__span-54-1"><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a><span class="kt">def</span><span class="w"> </span><span class="n">employeesByName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="o">[</span><span class="n">df</span><span class="o">[</span><span class="s1">&#39;employees&#39;</span><span class="o">]</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="o">[</span><span class="s1">&#39;Ronda&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;Udo&#39;</span><span class="o">]]</span>
</span></code></pre></div>
<div class="language-shell highlight"><span class="filename">output</span><pre><span></span><code><span id="__span-55-1"><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a><span class="w">               </span>employees
</span><span id="__span-55-2"><a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a><span class="w"> </span>employees<span class="w">  </span><span class="p">|</span><span class="w">  </span>department<span class="w">  </span><span class="p">|</span><span class="w">  </span>payroll<span class="w">  </span><span class="p">|</span>
</span><span id="__span-55-3"><a id="__codelineno-55-3" name="__codelineno-55-3" href="#__codelineno-55-3"></a>----------------------------------------
</span><span id="__span-55-4"><a id="__codelineno-55-4" name="__codelineno-55-4" href="#__codelineno-55-4"></a><span class="w">       </span>Udo<span class="w">  </span><span class="p">|</span><span class="w">       </span>sales<span class="w">  </span><span class="p">|</span><span class="w">    </span><span class="m">10000</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-55-5"><a id="__codelineno-55-5" name="__codelineno-55-5" href="#__codelineno-55-5"></a><span class="w">     </span>Ronda<span class="w">  </span><span class="p">|</span><span class="w">          </span>it<span class="w">  </span><span class="p">|</span><span class="w">    </span><span class="m">13000</span><span class="w">  </span><span class="p">|</span>
</span></code></pre></div>
<p>You can even try by a regular expression. Lets look for employees with an <strong>'o'</strong> in their name:</p>
<div class="language-groovy highlight"><span class="filename">regex</span><pre><span></span><code><span id="__span-56-1"><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a><span class="kt">def</span><span class="w"> </span><span class="n">employeesWithAnO</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="o">[</span><span class="n">df</span><span class="o">[</span><span class="s1">&#39;employees&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">==~</span><span class="w"> </span><span class="s">/.*o.*/</span><span class="w"> </span><span class="o">]</span>
</span></code></pre></div>
<div class="language-shell highlight"><span class="filename">output</span><pre><span></span><code><span id="__span-57-1"><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a><span class="w">               </span>employees
</span><span id="__span-57-2"><a id="__codelineno-57-2" name="__codelineno-57-2" href="#__codelineno-57-2"></a><span class="w"> </span>employees<span class="w">  </span><span class="p">|</span><span class="w">  </span>department<span class="w">  </span><span class="p">|</span><span class="w">  </span>payroll<span class="w">  </span><span class="p">|</span>
</span><span id="__span-57-3"><a id="__codelineno-57-3" name="__codelineno-57-3" href="#__codelineno-57-3"></a>----------------------------------------
</span><span id="__span-57-4"><a id="__codelineno-57-4" name="__codelineno-57-4" href="#__codelineno-57-4"></a><span class="w">       </span>Udo<span class="w">  </span><span class="p">|</span><span class="w">       </span>sales<span class="w">  </span><span class="p">|</span><span class="w">    </span><span class="m">10000</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-57-5"><a id="__codelineno-57-5" name="__codelineno-57-5" href="#__codelineno-57-5"></a><span class="w">      </span>John<span class="w">  </span><span class="p">|</span><span class="w">          </span>it<span class="w">  </span><span class="p">|</span><span class="w">    </span><span class="m">12000</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-57-6"><a id="__codelineno-57-6" name="__codelineno-57-6" href="#__codelineno-57-6"></a><span class="w">     </span>Ronda<span class="w">  </span><span class="p">|</span><span class="w">          </span>it<span class="w">  </span><span class="p">|</span><span class="w">    </span><span class="m">13000</span><span class="w">  </span><span class="p">|</span>
</span></code></pre></div>
<h4 id="dates">Dates</h4>
<p>Of course in time series is crucial to allow searches by time frame.</p>
<div class="language-groovy highlight"><span class="filename">dates</span><pre><span></span><code><span id="__span-58-1"><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a><span class="c1">// Using a given date as the beginning of our df dates series</span>
</span><span id="__span-58-2"><a id="__codelineno-58-2" name="__codelineno-58-2" href="#__codelineno-58-2"></a><span class="kt">def</span><span class="w"> </span><span class="n">initialDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LocalDate</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="s1">&#39;01/01/2000&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;dd/MM/yyyy&#39;</span><span class="o">)</span>
</span><span id="__span-58-3"><a id="__codelineno-58-3" name="__codelineno-58-3" href="#__codelineno-58-3"></a>
</span><span id="__span-58-4"><a id="__codelineno-58-4" name="__codelineno-58-4" href="#__codelineno-58-4"></a><span class="c1">// a dataframe containing the simulation of bicycles rented through 2000</span>
</span><span id="__span-58-5"><a id="__codelineno-58-5" name="__codelineno-58-5" href="#__codelineno-58-5"></a><span class="kt">def</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span>
</span><span id="__span-58-6"><a id="__codelineno-58-6" name="__codelineno-58-6" href="#__codelineno-58-6"></a><span class="w">    </span><span class="nl">dates:</span><span class="w"> </span><span class="o">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">365</span><span class="o">).</span><span class="na">collect</span><span class="o">(</span><span class="nl">initialDate:</span><span class="o">:</span><span class="n">plusDays</span><span class="o">),</span>
</span><span id="__span-58-7"><a id="__codelineno-58-7" name="__codelineno-58-7" href="#__codelineno-58-7"></a><span class="w">    </span><span class="nl">rented:</span><span class="w"> </span><span class="o">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">365</span><span class="o">).</span><span class="na">collect</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Random</span><span class="o">().</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">200</span><span class="o">)</span><span class="w"> </span><span class="o">}</span>
</span><span id="__span-58-8"><a id="__codelineno-58-8" name="__codelineno-58-8" href="#__codelineno-58-8"></a><span class="o">].</span><span class="na">toDataFrame</span><span class="o">(</span><span class="s2">&quot;rented bicycles 2000&quot;</span><span class="o">)</span>
</span></code></pre></div>
<div class="language-shell highlight"><span class="filename">output</span><pre><span></span><code><span id="__span-59-1"><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a>rented<span class="w"> </span>bicycles<span class="w"> </span><span class="m">2000</span>
</span><span id="__span-59-2"><a id="__codelineno-59-2" name="__codelineno-59-2" href="#__codelineno-59-2"></a><span class="w">  </span>dates<span class="w">     </span><span class="p">|</span><span class="w">  </span>rented<span class="w">  </span><span class="p">|</span>
</span><span id="__span-59-3"><a id="__codelineno-59-3" name="__codelineno-59-3" href="#__codelineno-59-3"></a>-------------------------
</span><span id="__span-59-4"><a id="__codelineno-59-4" name="__codelineno-59-4" href="#__codelineno-59-4"></a><span class="m">2000</span>-01-02<span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="m">41</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-59-5"><a id="__codelineno-59-5" name="__codelineno-59-5" href="#__codelineno-59-5"></a><span class="m">2000</span>-01-03<span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="m">47</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-59-6"><a id="__codelineno-59-6" name="__codelineno-59-6" href="#__codelineno-59-6"></a><span class="m">2000</span>-01-04<span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="m">27</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-59-7"><a id="__codelineno-59-7" name="__codelineno-59-7" href="#__codelineno-59-7"></a><span class="m">2000</span>-01-05<span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="m">95</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-59-8"><a id="__codelineno-59-8" name="__codelineno-59-8" href="#__codelineno-59-8"></a><span class="m">2000</span>-01-06<span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="m">30</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-59-9"><a id="__codelineno-59-9" name="__codelineno-59-9" href="#__codelineno-59-9"></a><span class="m">2000</span>-01-07<span class="w">  </span><span class="p">|</span><span class="w">     </span><span class="m">162</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-59-10"><a id="__codelineno-59-10" name="__codelineno-59-10" href="#__codelineno-59-10"></a><span class="m">2000</span>-01-08<span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="m">52</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-59-11"><a id="__codelineno-59-11" name="__codelineno-59-11" href="#__codelineno-59-11"></a><span class="m">2000</span>-01-09<span class="w">  </span><span class="p">|</span><span class="w">     </span><span class="m">197</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-59-12"><a id="__codelineno-59-12" name="__codelineno-59-12" href="#__codelineno-59-12"></a><span class="m">2000</span>-01-10<span class="w">  </span><span class="p">|</span><span class="w">     </span><span class="m">125</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-59-13"><a id="__codelineno-59-13" name="__codelineno-59-13" href="#__codelineno-59-13"></a><span class="m">2000</span>-01-11<span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="m">15</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-59-14"><a id="__codelineno-59-14" name="__codelineno-59-14" href="#__codelineno-59-14"></a><span class="w">       </span>...<span class="w">  </span><span class="p">|</span><span class="w">     </span>...<span class="w">  </span><span class="p">|</span>
</span></code></pre></div>
<p>What if we'd like to get only those records of december 2000 ?</p>
<div class="language-groovy highlight"><span class="filename">after</span><pre><span></span><code><span id="__span-60-1"><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a><span class="kt">def</span><span class="w"> </span><span class="n">lastMonth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="o">[</span><span class="n">df</span><span class="o">[</span><span class="s1">&#39;dates&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">LocalDate</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="s1">&#39;01/12/2000&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;dd/MM/yyyy&#39;</span><span class="o">)]</span>
</span></code></pre></div>
<div class="language-shell highlight"><span class="filename">output</span><pre><span></span><code><span id="__span-61-1"><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a><span class="w">  </span>rented<span class="w"> </span>bicycles<span class="w"> </span><span class="m">2000</span>
</span><span id="__span-61-2"><a id="__codelineno-61-2" name="__codelineno-61-2" href="#__codelineno-61-2"></a><span class="w">  </span>dates<span class="w">     </span><span class="p">|</span><span class="w">  </span>rented<span class="w">  </span><span class="p">|</span>
</span><span id="__span-61-3"><a id="__codelineno-61-3" name="__codelineno-61-3" href="#__codelineno-61-3"></a>-------------------------
</span><span id="__span-61-4"><a id="__codelineno-61-4" name="__codelineno-61-4" href="#__codelineno-61-4"></a><span class="m">2000</span>-12-01<span class="w">  </span><span class="p">|</span><span class="w">     </span><span class="m">104</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-61-5"><a id="__codelineno-61-5" name="__codelineno-61-5" href="#__codelineno-61-5"></a><span class="m">2000</span>-12-02<span class="w">  </span><span class="p">|</span><span class="w">     </span><span class="m">193</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-61-6"><a id="__codelineno-61-6" name="__codelineno-61-6" href="#__codelineno-61-6"></a><span class="m">2000</span>-12-03<span class="w">  </span><span class="p">|</span><span class="w">     </span><span class="m">107</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-61-7"><a id="__codelineno-61-7" name="__codelineno-61-7" href="#__codelineno-61-7"></a><span class="m">2000</span>-12-04<span class="w">  </span><span class="p">|</span><span class="w">     </span><span class="m">108</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-61-8"><a id="__codelineno-61-8" name="__codelineno-61-8" href="#__codelineno-61-8"></a><span class="m">2000</span>-12-05<span class="w">  </span><span class="p">|</span><span class="w">     </span><span class="m">193</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-61-9"><a id="__codelineno-61-9" name="__codelineno-61-9" href="#__codelineno-61-9"></a><span class="m">2000</span>-12-06<span class="w">  </span><span class="p">|</span><span class="w">     </span><span class="m">165</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-61-10"><a id="__codelineno-61-10" name="__codelineno-61-10" href="#__codelineno-61-10"></a><span class="m">2000</span>-12-07<span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="m">82</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-61-11"><a id="__codelineno-61-11" name="__codelineno-61-11" href="#__codelineno-61-11"></a><span class="m">2000</span>-12-08<span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="m">77</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-61-12"><a id="__codelineno-61-12" name="__codelineno-61-12" href="#__codelineno-61-12"></a><span class="m">2000</span>-12-09<span class="w">  </span><span class="p">|</span><span class="w">     </span><span class="m">176</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-61-13"><a id="__codelineno-61-13" name="__codelineno-61-13" href="#__codelineno-61-13"></a><span class="m">2000</span>-12-10<span class="w">  </span><span class="p">|</span><span class="w">     </span><span class="m">158</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-61-14"><a id="__codelineno-61-14" name="__codelineno-61-14" href="#__codelineno-61-14"></a><span class="w">       </span>...<span class="w">  </span><span class="p">|</span><span class="w">     </span>...<span class="w">  </span><span class="p">|</span>
</span><span id="__span-61-15"><a id="__codelineno-61-15" name="__codelineno-61-15" href="#__codelineno-61-15"></a><span class="m">2000</span>-12-31<span class="w">  </span><span class="p">|</span><span class="w">     </span><span class="m">150</span><span class="w">  </span><span class="p">|</span>
</span></code></pre></div>
<h4 id="and">&amp; and |</h4>
<p>You can combine any predicate with the operators <code>&amp;</code> and <code>|</code>. For example, lets filter by all years after 1995 <strong>AND</strong> entries with population less or equals 8000:</p>
<div class="language-groovy highlight"><span class="filename">AND</span><pre><span></span><code><span id="__span-62-1"><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a><span class="kt">def</span><span class="w"> </span><span class="n">result1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="o">[</span><span class="n">df</span><span class="o">[</span><span class="s1">&#39;years&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1995</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">df</span><span class="o">[</span><span class="s1">&#39;population&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">8000</span><span class="o">]</span>
</span></code></pre></div>
<p>Now filter by years less or equals to 1995 <strong>OR</strong> entries with population greater than 9000.</p>
<div class="language-groovy highlight"><span class="filename">OR</span><pre><span></span><code><span id="__span-63-1"><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a><span class="kt">def</span><span class="w"> </span><span class="n">result2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="o">[</span><span class="n">df</span><span class="o">[</span><span class="s1">&#39;years&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">1998</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">df</span><span class="o">[</span><span class="s1">&#39;population&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">9000</span><span class="o">]</span>
</span></code></pre></div>
<h4 id="summary">Summary</h4>
<p>Here you have the tables with the supported operators:</p>
<p>Arithmetic</p>
<table>
<thead>
<tr>
<th>Left</th>
<th>Right</th>
<th>Operator</th>
<th>Example</th>
<th>Status</th>
</tr>
</thead>
<tbody>
<tr>
<td>Series</td>
<td>Series</td>
<td>+</td>
<td><code>df['a'] + df['b']</code></td>
<td>Yes</td>
</tr>
<tr>
<td>Series</td>
<td>Series</td>
<td>-</td>
<td><code>df['a'] - df['b]</code></td>
<td>Yes</td>
</tr>
<tr>
<td>Series</td>
<td>Object</td>
<td>+</td>
<td><code>df['a'] + 1</code></td>
<td>Yes</td>
</tr>
<tr>
<td>Series</td>
<td>Object</td>
<td>-</td>
<td><code>df['a'] - 1</code></td>
<td>Yes</td>
</tr>
<tr>
<td>Series</td>
<td>Object</td>
<td>*</td>
<td><code>df['a'] * 2</code></td>
<td>Yes</td>
</tr>
<tr>
<td>Series</td>
<td>Object</td>
<td>/</td>
<td><code>df['a'] / 2</code></td>
<td>Yes</td>
</tr>
</tbody>
</table>
<p>filtering operators</p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Operator</th>
<th>Example</th>
<th>Status</th>
</tr>
</thead>
<tbody>
<tr>
<td>String</td>
<td>==</td>
<td><code>df['a'] == 'x'</code></td>
<td>Yes</td>
</tr>
<tr>
<td>String</td>
<td>!=</td>
<td><code>df['a'] != 'x'</code></td>
<td>Yes</td>
</tr>
<tr>
<td>String</td>
<td>==~</td>
<td><code>df['a'] ==~ /.*/</code></td>
<td>Yes</td>
</tr>
<tr>
<td>String</td>
<td>in</td>
<td><code>df['a'] in ['x']</code></td>
<td>Yes</td>
</tr>
<tr>
<td>Number</td>
<td>==</td>
<td><code>df['a'] == 1</code></td>
<td>Yes</td>
</tr>
<tr>
<td>Number</td>
<td>!=</td>
<td><code>df['a'] != 1</code></td>
<td>Yes</td>
</tr>
<tr>
<td>Number</td>
<td>&gt;</td>
<td><code>df['a'] &gt; 1</code></td>
<td>Yes</td>
</tr>
<tr>
<td>Number</td>
<td>&gt;=</td>
<td><code>df['a'] &gt;= 1</code></td>
<td>Yes</td>
</tr>
<tr>
<td>Number</td>
<td>&lt;</td>
<td><code>df['a'] &lt; 1</code></td>
<td>Yes</td>
</tr>
<tr>
<td>Number</td>
<td>&lt;=</td>
<td><code>df['a'] &lt;= 1</code></td>
<td>Yes</td>
</tr>
<tr>
<td>LocalDate</td>
<td>&gt;</td>
<td><code>df['a'] &gt; date</code></td>
<td>Yes</td>
</tr>
<tr>
<td>LocalDate</td>
<td>&gt;=</td>
<td><code>df['a'] &gt;= date</code></td>
<td>Yes</td>
</tr>
<tr>
<td>LocalDate</td>
<td>&lt;</td>
<td><code>df['a'] &lt; date</code></td>
<td>Yes</td>
</tr>
<tr>
<td>LocalDate</td>
<td>&lt;=</td>
<td><code>df['a'] &lt;= date</code></td>
<td>Yes</td>
</tr>
</tbody>
</table>
<h3 id="sorting_1">Sorting</h3>
<p>TODO</p>
<h3 id="mapping">Mapping</h3>
<p>TODO</p>
<h3 id="import-export">Import / Export</h3>
<h4 id="csv">CSV</h4>
<h5 id="reading">Reading</h5>
<p>You can read csv files via <code>Underdog.df().read_csv(...)</code> method. Here we are importing a csv files containing tornado
incidents in the USA:</p>
<div class="language-groovy highlight"><span class="filename">import csv</span><pre><span></span><code><span id="__span-64-1"><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a><span class="n">DataFrame</span><span class="w"> </span><span class="n">dataframe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Underdog</span><span class="o">.</span><span class="na">df</span><span class="o">().</span><span class="na">read_csv</span><span class="o">(</span><span class="s2">&quot;src/test/resources/data/tornadoes_1950-2014.csv&quot;</span><span class="o">)</span>
</span></code></pre></div>
<div class="language-shell highlight"><span class="filename">output</span><pre><span></span><code><span id="__span-65-1"><a id="__codelineno-65-1" name="__codelineno-65-1" href="#__codelineno-65-1"></a><span class="w">                               </span>tornadoes_1950-2014.csv
</span><span id="__span-65-2"><a id="__codelineno-65-2" name="__codelineno-65-2" href="#__codelineno-65-2"></a><span class="w">   </span>Date<span class="w">     </span><span class="p">|</span><span class="w">    </span>Time<span class="w">    </span><span class="p">|</span><span class="w">  </span>State<span class="w">  </span><span class="p">|</span><span class="w">  </span>State<span class="w"> </span>No<span class="w">  </span><span class="p">|</span><span class="w">  </span>Scale<span class="w">  </span><span class="p">|</span><span class="w">  </span>Injuries<span class="w">  </span><span class="p">|</span><span class="w">  </span>...<span class="w"> </span><span class="p">|</span>
</span><span id="__span-65-3"><a id="__codelineno-65-3" name="__codelineno-65-3" href="#__codelineno-65-3"></a>--------------------------------------------------------------------------------
</span><span id="__span-65-4"><a id="__codelineno-65-4" name="__codelineno-65-4" href="#__codelineno-65-4"></a><span class="m">1950</span>-01-03<span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">11</span>:00:00<span class="w">  </span><span class="p">|</span><span class="w">     </span>MO<span class="w">  </span><span class="p">|</span><span class="w">         </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="m">3</span><span class="w">  </span><span class="p">|</span><span class="w">         </span><span class="m">3</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>...<span class="w"> </span><span class="p">|</span>
</span><span id="__span-65-5"><a id="__codelineno-65-5" name="__codelineno-65-5" href="#__codelineno-65-5"></a><span class="m">1950</span>-01-03<span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">11</span>:00:00<span class="w">  </span><span class="p">|</span><span class="w">     </span>MO<span class="w">  </span><span class="p">|</span><span class="w">         </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="m">3</span><span class="w">  </span><span class="p">|</span><span class="w">         </span><span class="m">3</span><span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="p">|</span>
</span><span id="__span-65-6"><a id="__codelineno-65-6" name="__codelineno-65-6" href="#__codelineno-65-6"></a><span class="m">1950</span>-01-03<span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">11</span>:10:00<span class="w">  </span><span class="p">|</span><span class="w">     </span>IL<span class="w">  </span><span class="p">|</span><span class="w">         </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="m">3</span><span class="w">  </span><span class="p">|</span><span class="w">         </span><span class="m">0</span><span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="p">|</span>
</span><span id="__span-65-7"><a id="__codelineno-65-7" name="__codelineno-65-7" href="#__codelineno-65-7"></a><span class="m">1950</span>-01-03<span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">11</span>:55:00<span class="w">  </span><span class="p">|</span><span class="w">     </span>IL<span class="w">  </span><span class="p">|</span><span class="w">         </span><span class="m">2</span><span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="m">3</span><span class="w">  </span><span class="p">|</span><span class="w">         </span><span class="m">3</span><span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="p">|</span>
</span><span id="__span-65-8"><a id="__codelineno-65-8" name="__codelineno-65-8" href="#__codelineno-65-8"></a><span class="m">1950</span>-01-03<span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">16</span>:00:00<span class="w">  </span><span class="p">|</span><span class="w">     </span>OH<span class="w">  </span><span class="p">|</span><span class="w">         </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">         </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="p">|</span>
</span><span id="__span-65-9"><a id="__codelineno-65-9" name="__codelineno-65-9" href="#__codelineno-65-9"></a><span class="m">1950</span>-01-13<span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">05</span>:25:00<span class="w">  </span><span class="p">|</span><span class="w">     </span>AR<span class="w">  </span><span class="p">|</span><span class="w">         </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="m">3</span><span class="w">  </span><span class="p">|</span><span class="w">         </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="p">|</span>
</span><span id="__span-65-10"><a id="__codelineno-65-10" name="__codelineno-65-10" href="#__codelineno-65-10"></a><span class="m">1950</span>-01-25<span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">19</span>:30:00<span class="w">  </span><span class="p">|</span><span class="w">     </span>MO<span class="w">  </span><span class="p">|</span><span class="w">         </span><span class="m">2</span><span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="m">2</span><span class="w">  </span><span class="p">|</span><span class="w">         </span><span class="m">5</span><span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="p">|</span>
</span><span id="__span-65-11"><a id="__codelineno-65-11" name="__codelineno-65-11" href="#__codelineno-65-11"></a><span class="m">1950</span>-01-25<span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">21</span>:00:00<span class="w">  </span><span class="p">|</span><span class="w">     </span>IL<span class="w">  </span><span class="p">|</span><span class="w">         </span><span class="m">3</span><span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="m">2</span><span class="w">  </span><span class="p">|</span><span class="w">         </span><span class="m">0</span><span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="p">|</span>
</span><span id="__span-65-12"><a id="__codelineno-65-12" name="__codelineno-65-12" href="#__codelineno-65-12"></a><span class="m">1950</span>-01-26<span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">18</span>:00:00<span class="w">  </span><span class="p">|</span><span class="w">     </span>TX<span class="w">  </span><span class="p">|</span><span class="w">         </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="m">2</span><span class="w">  </span><span class="p">|</span><span class="w">         </span><span class="m">2</span><span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="p">|</span>
</span><span id="__span-65-13"><a id="__codelineno-65-13" name="__codelineno-65-13" href="#__codelineno-65-13"></a><span class="m">1950</span>-02-11<span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">13</span>:10:00<span class="w">  </span><span class="p">|</span><span class="w">     </span>TX<span class="w">  </span><span class="p">|</span><span class="w">         </span><span class="m">2</span><span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="m">2</span><span class="w">  </span><span class="p">|</span><span class="w">         </span><span class="m">0</span><span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="p">|</span>
</span><span id="__span-65-14"><a id="__codelineno-65-14" name="__codelineno-65-14" href="#__codelineno-65-14"></a><span class="w">       </span>...<span class="w">  </span><span class="p">|</span><span class="w">       </span>...<span class="w">  </span><span class="p">|</span><span class="w">    </span>...<span class="w">  </span><span class="p">|</span><span class="w">       </span>...<span class="w">  </span><span class="p">|</span><span class="w">    </span>...<span class="w">  </span><span class="p">|</span><span class="w">       </span>...<span class="w">  </span><span class="p">|</span><span class="w">  </span>...<span class="w"> </span><span class="p">|</span>
</span></code></pre></div>
<h5 id="separator">Separator</h5>
<p>By default the csv reader assumes the csv file is using comma (,) as the separator character, but you can provide a custom
separator. For example the following csv file content:</p>
<div class="language-shell highlight"><span class="filename">separator</span><pre><span></span><code><span id="__span-66-1"><a id="__codelineno-66-1" name="__codelineno-66-1" href="#__codelineno-66-1"></a>name<span class="p">;</span>age
</span><span id="__span-66-2"><a id="__codelineno-66-2" name="__codelineno-66-2" href="#__codelineno-66-2"></a>Lorna<span class="p">;</span><span class="m">34</span>
</span><span id="__span-66-3"><a id="__codelineno-66-3" name="__codelineno-66-3" href="#__codelineno-66-3"></a>Yule<span class="p">;</span><span class="m">63</span>
</span><span id="__span-66-4"><a id="__codelineno-66-4" name="__codelineno-66-4" href="#__codelineno-66-4"></a>Tom<span class="p">;</span><span class="m">28</span>
</span></code></pre></div>
<p>Can be read by using the <strong>sep</strong> argument:</p>
<div class="language-groovy highlight"><span class="filename">custom separator</span><pre><span></span><code><span id="__span-67-1"><a id="__codelineno-67-1" name="__codelineno-67-1" href="#__codelineno-67-1"></a><span class="kt">def</span><span class="w"> </span><span class="n">dataframe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Underdog</span><span class="o">.</span><span class="na">df</span><span class="o">().</span><span class="na">read_csv</span><span class="o">(</span><span class="n">filePath</span><span class="o">,</span><span class="w"> </span><span class="nl">sep:</span><span class="w"> </span><span class="s2">&quot;;&quot;</span><span class="o">)</span>
</span></code></pre></div>
<h5 id="duplicated-names">Duplicated names</h5>
<p>Sometimes you can find a csv where columns are repeated, by default if you don't specify you allow repeated columns
the import process will fail. Imagine we've got the following csv:</p>
<div class="language-shell highlight"><span class="filename">csv with repeated cols</span><pre><span></span><code><span id="__span-68-1"><a id="__codelineno-68-1" name="__codelineno-68-1" href="#__codelineno-68-1"></a>bronze,silver,gold,summer_total,bronze,silver,gold,winter_total
</span><span id="__span-68-2"><a id="__codelineno-68-2" name="__codelineno-68-2" href="#__codelineno-68-2"></a><span class="m">1</span>,2,1,4,1,1,1,3
</span></code></pre></div>
<p>To allow repeated columns you should set the <code>allowDuplicatedNames</code> flag to <strong>true</strong>.</p>
<div class="language-groovy highlight"><span class="filename">allow repeated cols</span><pre><span></span><code><span id="__span-69-1"><a id="__codelineno-69-1" name="__codelineno-69-1" href="#__codelineno-69-1"></a><span class="kt">def</span><span class="w"> </span><span class="n">dataframe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Underdog</span><span class="o">.</span><span class="na">df</span><span class="o">().</span><span class="na">read_csv</span><span class="o">(</span><span class="n">filePath</span><span class="o">,</span><span class="w"> </span><span class="nl">allowedDuplicatedNames:</span><span class="w"> </span><span class="kc">true</span><span class="o">)</span>
</span></code></pre></div>
<p>Then all repeated names will be prefixed in order with a number to avoid collisions:</p>
<div class="language-shell highlight"><span class="filename">output</span><pre><span></span><code><span id="__span-70-1"><a id="__codelineno-70-1" name="__codelineno-70-1" href="#__codelineno-70-1"></a><span class="w">                                        </span>io_repeated_cols.csv
</span><span id="__span-70-2"><a id="__codelineno-70-2" name="__codelineno-70-2" href="#__codelineno-70-2"></a><span class="w"> </span>bronze<span class="w"> </span><span class="p">|</span><span class="w">  </span>silver<span class="w"> </span><span class="p">|</span><span class="w">  </span>gold<span class="w"> </span><span class="p">|</span><span class="w">  </span>summer_total<span class="w"> </span><span class="p">|</span><span class="w">  </span>bronze-2<span class="w">  </span><span class="p">|</span><span class="w">  </span>silver-2<span class="w">  </span><span class="p">|</span><span class="w">  </span>gold-2<span class="w">  </span><span class="p">|</span><span class="w">  </span>winter_total<span class="p">|</span>
</span><span id="__span-70-3"><a id="__codelineno-70-3" name="__codelineno-70-3" href="#__codelineno-70-3"></a>-----------------------------------------------------------------------------------------------
</span><span id="__span-70-4"><a id="__codelineno-70-4" name="__codelineno-70-4" href="#__codelineno-70-4"></a><span class="w">      </span><span class="m">1</span><span class="w"> </span><span class="p">|</span><span class="w">       </span><span class="m">2</span><span class="w"> </span><span class="p">|</span><span class="w">     </span><span class="m">1</span><span class="w"> </span><span class="p">|</span><span class="w">             </span><span class="m">4</span><span class="w"> </span><span class="p">|</span><span class="w">         </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">         </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">       </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">           </span><span class="m">3</span><span class="w">  </span><span class="p">|</span>
</span></code></pre></div>
<h5 id="missing-values">Missing values</h5>
<p>If a csv file contains values which should be considered as well as missing values, we can pass this information before
reading the csv file.</p>
<div class="language-shell highlight"><span class="filename">csv file with missing data</span><pre><span></span><code><span id="__span-71-1"><a id="__codelineno-71-1" name="__codelineno-71-1" href="#__codelineno-71-1"></a>from,to,id
</span><span id="__span-71-2"><a id="__codelineno-71-2" name="__codelineno-71-2" href="#__codelineno-71-2"></a>N/C,Madrid,123
</span><span id="__span-71-3"><a id="__codelineno-71-3" name="__codelineno-71-3" href="#__codelineno-71-3"></a>Madrid,Paris,124
</span><span id="__span-71-4"><a id="__codelineno-71-4" name="__codelineno-71-4" href="#__codelineno-71-4"></a>Paris,London,125
</span><span id="__span-71-5"><a id="__codelineno-71-5" name="__codelineno-71-5" href="#__codelineno-71-5"></a>London,NONE,126
</span></code></pre></div>
<p>Here we're considering missing data the values <strong>N/C</strong> and <strong>NONE</strong>:</p>
<div class="language-groovy highlight"><span class="filename">considering missing data</span><pre><span></span><code><span id="__span-72-1"><a id="__codelineno-72-1" name="__codelineno-72-1" href="#__codelineno-72-1"></a><span class="kt">def</span><span class="w"> </span><span class="n">dataframe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Underdog</span><span class="o">.</span><span class="na">df</span><span class="o">().</span><span class="na">read_csv</span><span class="o">(</span><span class="n">filePath</span><span class="o">,</span><span class="w"> </span><span class="nl">nanValues:</span><span class="w"> </span><span class="o">[</span><span class="s1">&#39;NONE&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;N/C&#39;</span><span class="o">])</span>
</span></code></pre></div>
<p>That will inform the reader to consider cells containing that value as missing values:</p>
<div class="language-shell highlight"><span class="filename">output</span><pre><span></span><code><span id="__span-73-1"><a id="__codelineno-73-1" name="__codelineno-73-1" href="#__codelineno-73-1"></a>io_custom_missing_data.csv
</span><span id="__span-73-2"><a id="__codelineno-73-2" name="__codelineno-73-2" href="#__codelineno-73-2"></a><span class="w">  </span>from<span class="w">   </span><span class="p">|</span><span class="w">    </span>to<span class="w">    </span><span class="p">|</span><span class="w">  </span>id<span class="w">   </span><span class="p">|</span>
</span><span id="__span-73-3"><a id="__codelineno-73-3" name="__codelineno-73-3" href="#__codelineno-73-3"></a>-----------------------------
</span><span id="__span-73-4"><a id="__codelineno-73-4" name="__codelineno-73-4" href="#__codelineno-73-4"></a><span class="w">         </span><span class="p">|</span><span class="w">  </span>Madrid<span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">123</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-73-5"><a id="__codelineno-73-5" name="__codelineno-73-5" href="#__codelineno-73-5"></a><span class="w"> </span>Madrid<span class="w">  </span><span class="p">|</span><span class="w">   </span>Paris<span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">124</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-73-6"><a id="__codelineno-73-6" name="__codelineno-73-6" href="#__codelineno-73-6"></a><span class="w">  </span>Paris<span class="w">  </span><span class="p">|</span><span class="w">  </span>London<span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">125</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-73-7"><a id="__codelineno-73-7" name="__codelineno-73-7" href="#__codelineno-73-7"></a><span class="w"> </span>London<span class="w">  </span><span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w">  </span><span class="m">126</span><span class="w">  </span><span class="p">|</span>
</span></code></pre></div>
<h5 id="date-format">Date format</h5>
<p>If your csv files have a custom date format you can provide the date pattern as a parameter. Here we have a file
with a custom format:</p>
<div class="language-shell highlight"><span class="filename">custom date format</span><pre><span></span><code><span id="__span-74-1"><a id="__codelineno-74-1" name="__codelineno-74-1" href="#__codelineno-74-1"></a>Date,Close
</span><span id="__span-74-2"><a id="__codelineno-74-2" name="__codelineno-74-2" href="#__codelineno-74-2"></a><span class="m">2014</span>-12-05<span class="w"> </span><span class="m">00</span>:00:00+00:00,0.5267500281333923
</span><span id="__span-74-3"><a id="__codelineno-74-3" name="__codelineno-74-3" href="#__codelineno-74-3"></a><span class="m">2014</span>-12-08<span class="w"> </span><span class="m">00</span>:00:00+00:00,0.5199999809265137
</span><span id="__span-74-4"><a id="__codelineno-74-4" name="__codelineno-74-4" href="#__codelineno-74-4"></a><span class="m">2014</span>-12-09<span class="w"> </span><span class="m">00</span>:00:00+00:00,0.5182499885559082
</span></code></pre></div>
<p>Passing the pattern as parameter:</p>
<div class="language-groovy highlight"><span class="filename">custom date format</span><pre><span></span><code><span id="__span-75-1"><a id="__codelineno-75-1" name="__codelineno-75-1" href="#__codelineno-75-1"></a><span class="kt">def</span><span class="w"> </span><span class="n">dataframe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Underdog</span><span class="o">.</span><span class="na">df</span><span class="o">().</span><span class="na">read_csv</span><span class="o">(</span><span class="n">filePath</span><span class="o">,</span><span class="w"> </span><span class="nl">dateFormat:</span><span class="w"> </span><span class="s2">&quot;yyyy-MM-dd HH:mm:ss+00:00&quot;</span><span class="o">)</span>
</span></code></pre></div>
<p>Gives the following output:</p>
<div class="language-shell highlight"><span class="filename">output</span><pre><span></span><code><span id="__span-76-1"><a id="__codelineno-76-1" name="__codelineno-76-1" href="#__codelineno-76-1"></a><span class="w">      </span>io_custom_date_format.csv
</span><span id="__span-76-2"><a id="__codelineno-76-2" name="__codelineno-76-2" href="#__codelineno-76-2"></a><span class="w">   </span>Date<span class="w">     </span><span class="p">|</span><span class="w">        </span>Close<span class="w">         </span><span class="p">|</span>
</span><span id="__span-76-3"><a id="__codelineno-76-3" name="__codelineno-76-3" href="#__codelineno-76-3"></a>-------------------------------------
</span><span id="__span-76-4"><a id="__codelineno-76-4" name="__codelineno-76-4" href="#__codelineno-76-4"></a><span class="m">2014</span>-12-05<span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">0</span>.5267500281333923<span class="w">  </span><span class="p">|</span>
</span><span id="__span-76-5"><a id="__codelineno-76-5" name="__codelineno-76-5" href="#__codelineno-76-5"></a><span class="m">2014</span>-12-08<span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">0</span>.5199999809265137<span class="w">  </span><span class="p">|</span>
</span><span id="__span-76-6"><a id="__codelineno-76-6" name="__codelineno-76-6" href="#__codelineno-76-6"></a><span class="m">2014</span>-12-09<span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="m">0</span>.5182499885559082<span class="w">  </span><span class="p">|</span>
</span></code></pre></div>
<h5 id="skip-rowsfooter">Skip rows/footer</h5>
<p>If you're sure that there is data you'd like to avoid parsing, like nonsense data, you can skip parsing those rows. Check the following example:</p>
<div class="language-shell highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">csv file with comments</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-77-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-77-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-77-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-77-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-77-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-77-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-77-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-77-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-77-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-77-10">10</a></span>
<span class="normal"><a href="#__codelineno-77-11">11</a></span>
<span class="normal"><a href="#__codelineno-77-12">12</a></span>
<span class="normal"><a href="#__codelineno-77-13">13</a></span>
<span class="normal"><a href="#__codelineno-77-14">14</a></span>
<span class="normal"><a href="#__codelineno-77-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-77-1"><a id="__codelineno-77-1" name="__codelineno-77-1"></a><span class="c1"># some information about the data</span>
</span><span id="__span-77-2"><a id="__codelineno-77-2" name="__codelineno-77-2"></a><span class="c1"># col1: city</span>
</span><span id="__span-77-3"><a id="__codelineno-77-3" name="__codelineno-77-3"></a><span class="c1"># col2: weight</span>
</span><span id="__span-77-4"><a id="__codelineno-77-4" name="__codelineno-77-4"></a>col1,col2
</span><span id="__span-77-5"><a id="__codelineno-77-5" name="__codelineno-77-5"></a>NC,0
</span><span id="__span-77-6"><a id="__codelineno-77-6" name="__codelineno-77-6"></a>NC,0
</span><span id="__span-77-7"><a id="__codelineno-77-7" name="__codelineno-77-7"></a>NC,0
</span><span id="__span-77-8"><a id="__codelineno-77-8" name="__codelineno-77-8"></a>NC,0
</span><span id="__span-77-9"><a id="__codelineno-77-9" name="__codelineno-77-9"></a>Madrid,1
</span><span id="__span-77-10"><a id="__codelineno-77-10" name="__codelineno-77-10"></a>Paris,2
</span><span id="__span-77-11"><a id="__codelineno-77-11" name="__codelineno-77-11"></a>NC,0
</span><span id="__span-77-12"><a id="__codelineno-77-12" name="__codelineno-77-12"></a>NC,0
</span><span id="__span-77-13"><a id="__codelineno-77-13" name="__codelineno-77-13"></a>NC,0
</span><span id="__span-77-14"><a id="__codelineno-77-14" name="__codelineno-77-14"></a>NC,0
</span><span id="__span-77-15"><a id="__codelineno-77-15" name="__codelineno-77-15"></a><span class="c1"># another comment here</span>
</span></code></pre></div></td></tr></table></div>
<p>There are lines we don't want to consider when creating our dataframe:</p>
<ul>
<li>comments in the beginning of the file (lines 1-3)</li>
<li>comments in the end of the file (line 15)</li>
<li>rows we don't want to parse because they don't add any meaningful information (4-8 and 11-14)</li>
</ul>
<p>To avoid parsing any of these lines we can instruct the csv reader to skip lines in the header and/or in the
footer of the file:</p>
<div class="language-groovy highlight"><span class="filename">skipping rows</span><pre><span></span><code><span id="__span-78-1"><a id="__codelineno-78-1" name="__codelineno-78-1" href="#__codelineno-78-1"></a><span class="kt">def</span><span class="w"> </span><span class="n">dataframe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Underdog</span><span class="o">.</span><span class="na">df</span><span class="o">()</span>
</span><span id="__span-78-2"><a id="__codelineno-78-2" name="__codelineno-78-2" href="#__codelineno-78-2"></a><span class="w">    </span><span class="o">.</span><span class="na">read_csv</span><span class="o">(</span><span class="n">filePath</span><span class="o">,</span>
</span><span id="__span-78-3"><a id="__codelineno-78-3" name="__codelineno-78-3" href="#__codelineno-78-3"></a><span class="w">        </span><span class="nl">header:</span><span class="w"> </span><span class="kc">false</span><span class="o">,</span><span class="w">    </span><span class="c1">// not using first row as header</span>
</span><span id="__span-78-4"><a id="__codelineno-78-4" name="__codelineno-78-4" href="#__codelineno-78-4"></a><span class="w">        </span><span class="nl">skipRows:</span><span class="w"> </span><span class="mi">8</span><span class="o">,</span><span class="w">      </span><span class="c1">// skipping rows at the beginning of the file</span>
</span><span id="__span-78-5"><a id="__codelineno-78-5" name="__codelineno-78-5" href="#__codelineno-78-5"></a><span class="w">        </span><span class="nl">skipFooter:</span><span class="w"> </span><span class="mi">4</span><span class="w">     </span><span class="c1">// skipping rows at the end of the file</span>
</span><span id="__span-78-6"><a id="__codelineno-78-6" name="__codelineno-78-6" href="#__codelineno-78-6"></a><span class="w">    </span><span class="o">).</span><span class="na">renameSeries</span><span class="o">(</span><span class="nl">columns:</span><span class="w"> </span><span class="o">[</span><span class="s1">&#39;city&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;id&#39;</span><span class="o">])</span><span class="w"> </span><span class="c1">// renaming series names with the list passed as parameter</span>
</span></code></pre></div>
<div class="language-shell highlight"><span class="filename">output</span><pre><span></span><code><span id="__span-79-1"><a id="__codelineno-79-1" name="__codelineno-79-1" href="#__codelineno-79-1"></a>io_skipping_rows.csv
</span><span id="__span-79-2"><a id="__codelineno-79-2" name="__codelineno-79-2" href="#__codelineno-79-2"></a><span class="w"> </span>city<span class="w">   </span><span class="p">|</span><span class="w">  </span>id<span class="w">  </span><span class="p">|</span>
</span><span id="__span-79-3"><a id="__codelineno-79-3" name="__codelineno-79-3" href="#__codelineno-79-3"></a>-----------------
</span><span id="__span-79-4"><a id="__codelineno-79-4" name="__codelineno-79-4" href="#__codelineno-79-4"></a>Madrid<span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">1</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-79-5"><a id="__codelineno-79-5" name="__codelineno-79-5" href="#__codelineno-79-5"></a><span class="w"> </span>Paris<span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">2</span><span class="w">  </span><span class="p">|</span>
</span></code></pre></div>
<h5 id="max-chars-x-col">Max chars x col</h5>
<p>You can instruct the csv reader to avoid parsing columns with more than a number of characters.</p>
<div class="language-groovy highlight"><span class="filename">limiting col chars</span><pre><span></span><code><span id="__span-80-1"><a id="__codelineno-80-1" name="__codelineno-80-1" href="#__codelineno-80-1"></a><span class="kt">def</span><span class="w"> </span><span class="n">dataframe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Underdog</span><span class="o">.</span><span class="na">df</span><span class="o">().</span><span class="na">read_csv</span><span class="o">(</span><span class="n">filePath</span><span class="o">,</span><span class="w"> </span><span class="nl">maxCharsPerColumn:</span><span class="w"> </span><span class="mi">20</span><span class="o">)</span>
</span></code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If a column exceeds the number of characters the process will throw an exception</p>
</div>
<h5 id="max-cols">Max cols</h5>
<p>You can instruct the csv reader to avoid parsing more than a given number of columns.</p>
<div class="language-groovy highlight"><span class="filename">limiting number of cols</span><pre><span></span><code><span id="__span-81-1"><a id="__codelineno-81-1" name="__codelineno-81-1" href="#__codelineno-81-1"></a><span class="kt">def</span><span class="w"> </span><span class="n">dataframe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Underdog</span><span class="o">.</span><span class="na">df</span><span class="o">().</span><span class="na">read_csv</span><span class="o">(</span><span class="n">filePath</span><span class="o">,</span><span class="w"> </span><span class="nl">maxNumberOfColumns:</span><span class="w"> </span><span class="mi">2</span><span class="o">)</span>
</span></code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If the number of columns exceeds the number specified the process will throw an exception</p>
</div>
<h2 id="series">Series</h2>
<h3 id="intro">Intro</h3>
<p>A <strong>Series</strong> object represents a named one-dimensional array. It also supports operations and statistical methods. It also has operations to deal with missing values. You can create a <strong>Series</strong> object from different sources:</p>
<div class="language-groovy highlight"><span class="filename">create</span><pre><span></span><code><span id="__span-82-1"><a id="__codelineno-82-1" name="__codelineno-82-1" href="#__codelineno-82-1"></a><span class="c1">// from a range of numbers</span>
</span><span id="__span-82-2"><a id="__codelineno-82-2" name="__codelineno-82-2" href="#__codelineno-82-2"></a><span class="kt">def</span><span class="w"> </span><span class="n">numbers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">4</span><span class="o">).</span><span class="na">toSeries</span><span class="o">(</span><span class="s2">&quot;numbers&quot;</span><span class="o">)</span>
</span><span id="__span-82-3"><a id="__codelineno-82-3" name="__codelineno-82-3" href="#__codelineno-82-3"></a>
</span><span id="__span-82-4"><a id="__codelineno-82-4" name="__codelineno-82-4" href="#__codelineno-82-4"></a><span class="c1">// from a range of letters</span>
</span><span id="__span-82-5"><a id="__codelineno-82-5" name="__codelineno-82-5" href="#__codelineno-82-5"></a><span class="kt">def</span><span class="w"> </span><span class="n">letters</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">(</span><span class="s1">&#39;A&#39;</span><span class="o">..</span><span class="s1">&#39;C&#39;</span><span class="o">).</span><span class="na">toSeries</span><span class="o">(</span><span class="s2">&quot;letters&quot;</span><span class="o">)</span>
</span><span id="__span-82-6"><a id="__codelineno-82-6" name="__codelineno-82-6" href="#__codelineno-82-6"></a>
</span><span id="__span-82-7"><a id="__codelineno-82-7" name="__codelineno-82-7" href="#__codelineno-82-7"></a><span class="c1">// from a list</span>
</span><span id="__span-82-8"><a id="__codelineno-82-8" name="__codelineno-82-8" href="#__codelineno-82-8"></a><span class="kt">def</span><span class="w"> </span><span class="n">stuff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="mi">2</span><span class="o">,</span><span class="w"> </span><span class="kc">null</span><span class="o">,</span><span class="w"> </span><span class="mi">3</span><span class="o">,</span><span class="w"> </span><span class="mi">4</span><span class="o">].</span><span class="na">toSeries</span><span class="o">(</span><span class="s2">&quot;stuff&quot;</span><span class="o">)</span>
</span></code></pre></div>
<p>You can use operator symbols to apply simple operations over the Series object:</p>
<div class="language-groovy highlight"><span class="filename">operations</span><pre><span></span><code><span id="__span-83-1"><a id="__codelineno-83-1" name="__codelineno-83-1" href="#__codelineno-83-1"></a><span class="c1">// multiplying a series by a number</span>
</span><span id="__span-83-2"><a id="__codelineno-83-2" name="__codelineno-83-2" href="#__codelineno-83-2"></a><span class="kt">def</span><span class="w"> </span><span class="n">doubleSeries</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numbers</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span>
</span><span id="__span-83-3"><a id="__codelineno-83-3" name="__codelineno-83-3" href="#__codelineno-83-3"></a>
</span><span id="__span-83-4"><a id="__codelineno-83-4" name="__codelineno-83-4" href="#__codelineno-83-4"></a><span class="c1">// multiplying a series by another series</span>
</span><span id="__span-83-5"><a id="__codelineno-83-5" name="__codelineno-83-5" href="#__codelineno-83-5"></a><span class="kt">def</span><span class="w"> </span><span class="n">rowProduct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numbers</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">stuff</span><span class="o">.</span><span class="na">dropna</span><span class="o">()</span>
</span><span id="__span-83-6"><a id="__codelineno-83-6" name="__codelineno-83-6" href="#__codelineno-83-6"></a>
</span><span id="__span-83-7"><a id="__codelineno-83-7" name="__codelineno-83-7" href="#__codelineno-83-7"></a><span class="c1">// dividing a series</span>
</span><span id="__span-83-8"><a id="__codelineno-83-8" name="__codelineno-83-8" href="#__codelineno-83-8"></a><span class="kt">def</span><span class="w"> </span><span class="n">halves</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stuff</span><span class="w"> </span><span class="s">/ 2</span>
</span><span id="__span-83-9"><a id="__codelineno-83-9" name="__codelineno-83-9" href="#__codelineno-83-9"></a>
</span><span id="__span-83-10"><a id="__codelineno-83-10" name="__codelineno-83-10" href="#__codelineno-83-10"></a><span class="s">/</span><span class="o">/</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="n">transformation</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">create</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">series</span>
</span><span id="__span-83-11"><a id="__codelineno-83-11" name="__codelineno-83-11" href="#__codelineno-83-11"></a><span class="kt">def</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">letters</span><span class="o">(</span><span class="n">String</span><span class="o">,</span><span class="w"> </span><span class="n">String</span><span class="o">)</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="s2">&quot;letter-$it&quot;</span><span class="o">.</span><span class="na">toString</span><span class="o">()</span><span class="w"> </span><span class="o">}</span>
</span></code></pre></div>
<p>Sometimes you may want to analyze a given Series object by using statistical methods:</p>
<div class="language-groovy highlight"><span class="filename">statistics</span><pre><span></span><code><span id="__span-84-1"><a id="__codelineno-84-1" name="__codelineno-84-1" href="#__codelineno-84-1"></a><span class="kt">def</span><span class="w"> </span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">doubleSeries</span><span class="o">.</span><span class="na">mean</span><span class="o">()</span>
</span><span id="__span-84-2"><a id="__codelineno-84-2" name="__codelineno-84-2" href="#__codelineno-84-2"></a><span class="kt">def</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">doubleSeries</span><span class="o">.</span><span class="na">max</span><span class="o">()</span>
</span><span id="__span-84-3"><a id="__codelineno-84-3" name="__codelineno-84-3" href="#__codelineno-84-3"></a><span class="kt">def</span><span class="w"> </span><span class="n">min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">doubleSeries</span><span class="o">.</span><span class="na">min</span><span class="o">()</span>
</span><span id="__span-84-4"><a id="__codelineno-84-4" name="__codelineno-84-4" href="#__codelineno-84-4"></a><span class="kt">def</span><span class="w"> </span><span class="n">avg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">doubleSeries</span><span class="o">.</span><span class="na">avg</span><span class="o">()</span>
</span></code></pre></div>
<p>You can find all statistical available methods in the <code>underdog.impl.extensions.SeriesStatsExtensions</code> class.</p>
<h3 id="creating">Creating</h3>
<p>Series are meant to be created from collections or as a transformation from another Series.</p>
<p>The only way to create a <strong>Series</strong> from a collection is invoking the extension method <code>toSeries()</code> from a list:</p>
<div class="language-groovy highlight"><span class="filename">collection extension</span><pre><span></span><code><span id="__span-85-1"><a id="__codelineno-85-1" name="__codelineno-85-1" href="#__codelineno-85-1"></a><span class="n">Series</span><span class="w"> </span><span class="n">series</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="mi">2</span><span class="o">,</span><span class="w"> </span><span class="mi">3</span><span class="o">].</span><span class="na">toSeries</span><span class="o">(</span><span class="s2">&quot;numbers&quot;</span><span class="o">)</span>
</span></code></pre></div>
<p>Most of the time we will be dealing with a Series creation inside the scope of a Dataframe. Sometimes as the result of the transformation of another series, sometimes because we would like to fill a series from a constant value.</p>
<p>Lets say we have a DataFrame with some Series:</p>
<div class="language-groovy highlight"><span class="filename">sample dataframe</span><pre><span></span><code><span id="__span-86-1"><a id="__codelineno-86-1" name="__codelineno-86-1" href="#__codelineno-86-1"></a><span class="kt">def</span><span class="w"> </span><span class="n">numbers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Underdog</span><span class="o">.</span><span class="na">df</span><span class="o">().</span><span class="na">from</span><span class="o">([</span><span class="nl">numbers:</span><span class="w"> </span><span class="mi">1</span><span class="o">..</span><span class="mi">10</span><span class="o">],</span><span class="w"> </span><span class="s2">&quot;numbers&quot;</span><span class="o">)</span>
</span></code></pre></div>
<div class="language-shell highlight"><span class="filename">output</span><pre><span></span><code><span id="__span-87-1"><a id="__codelineno-87-1" name="__codelineno-87-1" href="#__codelineno-87-1"></a><span class="w"> </span>numbers
</span><span id="__span-87-2"><a id="__codelineno-87-2" name="__codelineno-87-2" href="#__codelineno-87-2"></a><span class="w"> </span>numbers<span class="w">  </span><span class="p">|</span>
</span><span id="__span-87-3"><a id="__codelineno-87-3" name="__codelineno-87-3" href="#__codelineno-87-3"></a>-----------
</span><span id="__span-87-4"><a id="__codelineno-87-4" name="__codelineno-87-4" href="#__codelineno-87-4"></a><span class="w">       </span><span class="m">1</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-87-5"><a id="__codelineno-87-5" name="__codelineno-87-5" href="#__codelineno-87-5"></a><span class="w">       </span><span class="m">2</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-87-6"><a id="__codelineno-87-6" name="__codelineno-87-6" href="#__codelineno-87-6"></a><span class="w">       </span><span class="m">3</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-87-7"><a id="__codelineno-87-7" name="__codelineno-87-7" href="#__codelineno-87-7"></a><span class="w">       </span><span class="m">4</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-87-8"><a id="__codelineno-87-8" name="__codelineno-87-8" href="#__codelineno-87-8"></a><span class="w">       </span><span class="m">5</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-87-9"><a id="__codelineno-87-9" name="__codelineno-87-9" href="#__codelineno-87-9"></a><span class="w">       </span><span class="m">6</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-87-10"><a id="__codelineno-87-10" name="__codelineno-87-10" href="#__codelineno-87-10"></a><span class="w">       </span><span class="m">7</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-87-11"><a id="__codelineno-87-11" name="__codelineno-87-11" href="#__codelineno-87-11"></a><span class="w">       </span><span class="m">8</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-87-12"><a id="__codelineno-87-12" name="__codelineno-87-12" href="#__codelineno-87-12"></a><span class="w">       </span><span class="m">9</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-87-13"><a id="__codelineno-87-13" name="__codelineno-87-13" href="#__codelineno-87-13"></a><span class="w">      </span><span class="m">10</span><span class="w">  </span><span class="p">|</span>
</span></code></pre></div>
<p>And we want to create a new series named <strong>by_two</strong> with the result of multiplying all numbers in the <strong>numbers</strong> series:</p>
<div class="language-groovy highlight"><span class="filename">new series</span><pre><span></span><code><span id="__span-88-1"><a id="__codelineno-88-1" name="__codelineno-88-1" href="#__codelineno-88-1"></a><span class="n">numbers</span><span class="o">[</span><span class="s1">&#39;by_two&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numbers</span><span class="o">[</span><span class="s1">&#39;numbers&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span>
</span></code></pre></div>
<div class="language-shell highlight"><span class="filename">output</span><pre><span></span><code><span id="__span-89-1"><a id="__codelineno-89-1" name="__codelineno-89-1" href="#__codelineno-89-1"></a><span class="w">       </span>numbers
</span><span id="__span-89-2"><a id="__codelineno-89-2" name="__codelineno-89-2" href="#__codelineno-89-2"></a><span class="w"> </span>numbers<span class="w">  </span><span class="p">|</span><span class="w">  </span>by_two<span class="w">  </span><span class="p">|</span>
</span><span id="__span-89-3"><a id="__codelineno-89-3" name="__codelineno-89-3" href="#__codelineno-89-3"></a>----------------------
</span><span id="__span-89-4"><a id="__codelineno-89-4" name="__codelineno-89-4" href="#__codelineno-89-4"></a><span class="w">       </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">       </span><span class="m">2</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-89-5"><a id="__codelineno-89-5" name="__codelineno-89-5" href="#__codelineno-89-5"></a><span class="w">       </span><span class="m">2</span><span class="w">  </span><span class="p">|</span><span class="w">       </span><span class="m">4</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-89-6"><a id="__codelineno-89-6" name="__codelineno-89-6" href="#__codelineno-89-6"></a><span class="w">       </span><span class="m">3</span><span class="w">  </span><span class="p">|</span><span class="w">       </span><span class="m">6</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-89-7"><a id="__codelineno-89-7" name="__codelineno-89-7" href="#__codelineno-89-7"></a><span class="w">       </span><span class="m">4</span><span class="w">  </span><span class="p">|</span><span class="w">       </span><span class="m">8</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-89-8"><a id="__codelineno-89-8" name="__codelineno-89-8" href="#__codelineno-89-8"></a><span class="w">       </span><span class="m">5</span><span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="m">10</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-89-9"><a id="__codelineno-89-9" name="__codelineno-89-9" href="#__codelineno-89-9"></a><span class="w">       </span><span class="m">6</span><span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="m">12</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-89-10"><a id="__codelineno-89-10" name="__codelineno-89-10" href="#__codelineno-89-10"></a><span class="w">       </span><span class="m">7</span><span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="m">14</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-89-11"><a id="__codelineno-89-11" name="__codelineno-89-11" href="#__codelineno-89-11"></a><span class="w">       </span><span class="m">8</span><span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="m">16</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-89-12"><a id="__codelineno-89-12" name="__codelineno-89-12" href="#__codelineno-89-12"></a><span class="w">       </span><span class="m">9</span><span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="m">18</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-89-13"><a id="__codelineno-89-13" name="__codelineno-89-13" href="#__codelineno-89-13"></a><span class="w">      </span><span class="m">10</span><span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="m">20</span><span class="w">  </span><span class="p">|</span>
</span></code></pre></div>
<p>You can also create a new Series inside a dataframe filling all rows with the same value:</p>
<div class="language-groovy highlight"><span class="filename">series from value</span><pre><span></span><code><span id="__span-90-1"><a id="__codelineno-90-1" name="__codelineno-90-1" href="#__codelineno-90-1"></a><span class="n">numbers</span><span class="o">[</span><span class="s1">&#39;one&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
</span></code></pre></div>
<div class="language-shell highlight"><span class="filename">output</span><pre><span></span><code><span id="__span-91-1"><a id="__codelineno-91-1" name="__codelineno-91-1" href="#__codelineno-91-1"></a><span class="w">           </span>numbers
</span><span id="__span-91-2"><a id="__codelineno-91-2" name="__codelineno-91-2" href="#__codelineno-91-2"></a><span class="w"> </span>numbers<span class="w">  </span><span class="p">|</span><span class="w">  </span>by_two<span class="w">  </span><span class="p">|</span><span class="w">  </span>one<span class="w">  </span><span class="p">|</span>
</span><span id="__span-91-3"><a id="__codelineno-91-3" name="__codelineno-91-3" href="#__codelineno-91-3"></a>------------------------------
</span><span id="__span-91-4"><a id="__codelineno-91-4" name="__codelineno-91-4" href="#__codelineno-91-4"></a><span class="w">       </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w">       </span><span class="m">2</span><span class="w">  </span><span class="p">|</span><span class="w">    </span><span class="m">1</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-91-5"><a id="__codelineno-91-5" name="__codelineno-91-5" href="#__codelineno-91-5"></a><span class="w">       </span><span class="m">2</span><span class="w">  </span><span class="p">|</span><span class="w">       </span><span class="m">4</span><span class="w">  </span><span class="p">|</span><span class="w">    </span><span class="m">1</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-91-6"><a id="__codelineno-91-6" name="__codelineno-91-6" href="#__codelineno-91-6"></a><span class="w">       </span><span class="m">3</span><span class="w">  </span><span class="p">|</span><span class="w">       </span><span class="m">6</span><span class="w">  </span><span class="p">|</span><span class="w">    </span><span class="m">1</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-91-7"><a id="__codelineno-91-7" name="__codelineno-91-7" href="#__codelineno-91-7"></a><span class="w">       </span><span class="m">4</span><span class="w">  </span><span class="p">|</span><span class="w">       </span><span class="m">8</span><span class="w">  </span><span class="p">|</span><span class="w">    </span><span class="m">1</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-91-8"><a id="__codelineno-91-8" name="__codelineno-91-8" href="#__codelineno-91-8"></a><span class="w">       </span><span class="m">5</span><span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="m">10</span><span class="w">  </span><span class="p">|</span><span class="w">    </span><span class="m">1</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-91-9"><a id="__codelineno-91-9" name="__codelineno-91-9" href="#__codelineno-91-9"></a><span class="w">       </span><span class="m">6</span><span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="m">12</span><span class="w">  </span><span class="p">|</span><span class="w">    </span><span class="m">1</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-91-10"><a id="__codelineno-91-10" name="__codelineno-91-10" href="#__codelineno-91-10"></a><span class="w">       </span><span class="m">7</span><span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="m">14</span><span class="w">  </span><span class="p">|</span><span class="w">    </span><span class="m">1</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-91-11"><a id="__codelineno-91-11" name="__codelineno-91-11" href="#__codelineno-91-11"></a><span class="w">       </span><span class="m">8</span><span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="m">16</span><span class="w">  </span><span class="p">|</span><span class="w">    </span><span class="m">1</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-91-12"><a id="__codelineno-91-12" name="__codelineno-91-12" href="#__codelineno-91-12"></a><span class="w">       </span><span class="m">9</span><span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="m">18</span><span class="w">  </span><span class="p">|</span><span class="w">    </span><span class="m">1</span><span class="w">  </span><span class="p">|</span>
</span><span id="__span-91-13"><a id="__codelineno-91-13" name="__codelineno-91-13" href="#__codelineno-91-13"></a><span class="w">      </span><span class="m">10</span><span class="w">  </span><span class="p">|</span><span class="w">      </span><span class="m">20</span><span class="w">  </span><span class="p">|</span><span class="w">    </span><span class="m">1</span><span class="w">  </span><span class="p">|</span>
</span></code></pre></div>
<h3 id="statistics">Statistics</h3>
<p>TODO</p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.indexes", "toc.integrate", "navigation.top", "content.tabs.link"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
    
  </body>
</html>